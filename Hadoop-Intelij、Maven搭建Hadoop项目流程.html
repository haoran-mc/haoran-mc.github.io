<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-05-28 Sat 02:53 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Intelij+Maven搭建Hadoop项目流程</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">Intelij+Maven搭建Hadoop项目流程</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgdb43125">1. 创建工程</a></li>
<li><a href="#orgc084819">2. 通过 maven 导入项目依赖 jar 包</a></li>
<li><a href="#org8b13d69">3. 编写 hdfs 读写程序</a></li>
<li><a href="#orga3d9ee7">4. 通过运行 jar 包的方式验证</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgdb43125" class="outline-2">
<h2 id="orgdb43125">1. 创建工程</h2>
<div class="outline-text-2" id="text-orgdb43125">
<p>
点击 project &#x2013; Maven &#x2013; next<br>
</p>

<img src="./images/Hadoop-IDEA_Maven搭建项目01.png" width="800px" />
</div>
</div>
<div id="outline-container-orgc084819" class="outline-2">
<h2 id="orgc084819">2. 通过 maven 导入项目依赖 jar 包</h2>
<div class="outline-text-2" id="text-orgc084819">
<ol class="org-ol">
<li><p>
设置 maven 自动导入依赖 jar 包<br>
</p>

<img src="./images/Hadoop-IDEA_Maven搭建项目02.png" width="800px" />

<img src="./images/Hadoop-IDEA_Maven搭建项目03.png" width="800px" /></li>

<li><p>
配置 pom.xml 文件<br>
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #268bd2; font-weight: bold;">xml</span> <span style="color: #af875f;">version="1.0" encoding="UTF-8"</span>?&gt;
&lt;<span style="color: #d75fd7; font-weight: bold;">project</span> <span style="color: #268bd2;">xmlns</span>=<span style="color: #2aa198;">"http://maven.apache.org/POM/4.0.0"</span>
         <span style="color: #268bd2;">xmlns</span>:<span style="color: #8787d7;">xsi</span>=<span style="color: #2aa198;">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span style="color: #268bd2;">xsi</span>:<span style="color: #8787d7;">schemaLocation</span>=<span style="color: #2aa198;">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;
  &lt;<span style="color: #d75fd7; font-weight: bold;">modelVersion</span>&gt;4.0.0&lt;/<span style="color: #d75fd7; font-weight: bold;">modelVersion</span>&gt;

  &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;com.ran.hadoop&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
  &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;upload&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
  &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;1.0-SNAPSHOT&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
  &lt;<span style="color: #d75fd7; font-weight: bold;">packaging</span>&gt;jar&lt;/<span style="color: #d75fd7; font-weight: bold;">packaging</span>&gt;

  &lt;<span style="color: #d75fd7; font-weight: bold;">properties</span>&gt;
    <span style="color: #008787; background-color: #262626;">&lt;!-- </span><span style="color: #008787; background-color: #262626;">&#36825;&#37324;&#26159;&#20320;&#30340; hadoop &#29256;&#26412; </span><span style="color: #008787; background-color: #262626;">--&gt;</span>
    &lt;<span style="color: #d75fd7; font-weight: bold;">hadoop.version</span>&gt;2.7.3&lt;/<span style="color: #d75fd7; font-weight: bold;">hadoop.version</span>&gt;
  &lt;/<span style="color: #d75fd7; font-weight: bold;">properties</span>&gt;

  &lt;<span style="color: #d75fd7; font-weight: bold;">dependencies</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;commons-cli&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;commons-cli&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;1.2&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;commons-logging&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;commons-logging&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;1.1.3&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;org.apache.hadoop&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;hadoop-mapreduce-client-jobclient&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;${hadoop.version}&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;org.apache.hadoop&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;hadoop-common&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;${hadoop.version}&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;org.apache.hadoop&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;hadoop-hdfs&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;${hadoop.version}&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;org.apache.hadoop&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;hadoop-mapreduce-client-app&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;${hadoop.version}&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
    &lt;<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;org.apache.hadoop&lt;/<span style="color: #d75fd7; font-weight: bold;">groupId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;hadoop-mapreduce-client-hs&lt;/<span style="color: #d75fd7; font-weight: bold;">artifactId</span>&gt;
      &lt;<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;${hadoop.version}&lt;/<span style="color: #d75fd7; font-weight: bold;">version</span>&gt;
    &lt;/<span style="color: #d75fd7; font-weight: bold;">dependency</span>&gt;
  &lt;/<span style="color: #d75fd7; font-weight: bold;">dependencies</span>&gt;
&lt;/<span style="color: #d75fd7; font-weight: bold;">project</span>&gt;

</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-org8b13d69" class="outline-2">
<h2 id="org8b13d69">3. 编写 hdfs 读写程序</h2>
<div class="outline-text-2" id="text-org8b13d69">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #268bd2; font-weight: bold;">package</span> com.ran.hadoop.<span style="color: #d75fd7;">hdfs</span>;

<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">conf</span>.<span style="color: #df005f; font-weight: bold;">Configuration</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">fs</span>.<span style="color: #df005f; font-weight: bold;">FileSystem</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">fs</span>.<span style="color: #df005f; font-weight: bold;">Path</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">io</span>.<span style="color: #df005f; font-weight: bold;">IOUtils</span>;

<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">java</span>.<span style="color: #d75fd7;">io</span>.*;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">java</span>.<span style="color: #d75fd7;">net</span>.<span style="color: #df005f; font-weight: bold;">URI</span>;
<span style="color: #af875f;">/**</span>
<span style="color: #af875f;"> * &#23558;&#26412;&#22320;&#25991;&#20214;&#31995;&#32479;&#30340;&#25991;&#20214;&#36890;&#36807;java-API&#20889;&#20837;&#21040;HDFS&#25991;&#20214;</span>
<span style="color: #af875f;"> */</span>
<span style="color: #268bd2; font-weight: bold;">public</span> <span style="color: #268bd2; font-weight: bold;">class</span> <span style="color: #df005f; font-weight: bold;">FileCopyFromLocal</span> {
    <span style="color: #268bd2; font-weight: bold;">public</span> <span style="color: #268bd2; font-weight: bold;">static</span> <span style="color: #df005f; font-weight: bold;">void</span> <span style="color: #d75fd7; font-weight: bold;">main</span>(<span style="color: #df005f; font-weight: bold;">String</span>[] <span style="color: #8787d7;">args</span>) {
        <span style="color: #df005f; font-weight: bold;">Configuration</span> <span style="color: #8787d7;">configuration</span> = <span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">Configuration</span>();
        configuration.set(<span style="color: #2aa198;">"fs.hdfs.impl"</span>, <span style="color: #2aa198;">"org.apache.hadoop.hdfs.DistributedFileSystem"</span>);
        <span style="color: #df005f; font-weight: bold;">String</span> <span style="color: #8787d7;">source</span> = <span style="color: #2aa198;">"C:\\files\\file03.txt"</span>;
        <span style="color: #df005f; font-weight: bold;">String</span> <span style="color: #8787d7;">destination</span> = <span style="color: #2aa198;">"hdfs://localhost:9000/files/file03.txt"</span>;
        <span style="color: #268bd2; font-weight: bold;">try</span> {
            <span style="color: #df005f; font-weight: bold;">InputStream</span> <span style="color: #8787d7;">in</span> = <span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">BufferedInputStream</span>(<span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">FileInputStream</span>(source));
            <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">HDFS&#35835;&#20889;&#30340;&#37197;&#32622;&#25991;&#20214;</span>
            <span style="color: #df005f; font-weight: bold;">Configuration</span> <span style="color: #8787d7;">conf</span> = <span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">Configuration</span>();
            <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#29983;&#25104;&#19968;&#20010;&#25991;&#20214;&#31995;&#32479;&#23545;&#35937;</span>
            <span style="color: #df005f; font-weight: bold;">FileSystem</span> <span style="color: #8787d7;">fs</span> = FileSystem.get(URI.create(destination), conf);
            <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#29983;&#25104;&#19968;&#20010;&#36755;&#20986;&#27969;</span>
            <span style="color: #df005f; font-weight: bold;">OutputStream</span> <span style="color: #8787d7;">out</span> = fs.create(<span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">Path</span>(destination));
            IOUtils.copyBytes(in, out, 4096, <span style="color: #d75fd7;">true</span>);
        } <span style="color: #268bd2; font-weight: bold;">catch</span> (<span style="color: #df005f; font-weight: bold;">FileNotFoundException</span> <span style="color: #8787d7;">e</span>) {
            e.printStackTrace();
        } <span style="color: #268bd2; font-weight: bold;">catch</span> (<span style="color: #df005f; font-weight: bold;">IOException</span> <span style="color: #8787d7;">e</span>) {
            e.printStackTrace();
        }
    }
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#25226; hdfs &#20013;&#30340;&#25991;&#20214;&#20256;&#36755;&#21040;&#26412;&#22320;</span>
<span style="color: #268bd2; font-weight: bold;">package</span> com.ran.hadoop.<span style="color: #d75fd7;">hdfs</span>;

<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">conf</span>.<span style="color: #df005f; font-weight: bold;">Configuration</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">fs</span>.<span style="color: #df005f; font-weight: bold;">FSDataInputStream</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">fs</span>.<span style="color: #df005f; font-weight: bold;">FileSystem</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">fs</span>.<span style="color: #df005f; font-weight: bold;">Path</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">org</span>.<span style="color: #d75fd7;">apache</span>.<span style="color: #d75fd7;">hadoop</span>.<span style="color: #d75fd7;">io</span>.<span style="color: #df005f; font-weight: bold;">IOUtils</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">java</span>.<span style="color: #d75fd7;">io</span>.<span style="color: #df005f; font-weight: bold;">BufferedOutputStream</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">java</span>.<span style="color: #d75fd7;">io</span>.<span style="color: #df005f; font-weight: bold;">FileOutputStream</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">java</span>.<span style="color: #d75fd7;">io</span>.<span style="color: #df005f; font-weight: bold;">IOException</span>;
<span style="color: #268bd2; font-weight: bold;">import</span> <span style="color: #d75fd7;">java</span>.<span style="color: #d75fd7;">net</span>.<span style="color: #df005f; font-weight: bold;">URI</span>;

<span style="color: #af875f;">/**</span>
<span style="color: #af875f;"> * &#20174;HDFS&#35835;&#21462;&#25991;&#20214;</span>
<span style="color: #af875f;"> * &#25171;&#21253;&#36816;&#34892;jar&#21253; $ hadoop jar com.ran.hadoop-1.0-SNAPSHOT.jar  com.ran.hadoop.hdfs.FileReadFromHdfs</span>
<span style="color: #af875f;"> */</span>
<span style="color: #268bd2; font-weight: bold;">public</span> <span style="color: #268bd2; font-weight: bold;">class</span> <span style="color: #df005f; font-weight: bold;">FileReadFromHdfs</span> {
    <span style="color: #268bd2; font-weight: bold;">public</span> <span style="color: #268bd2; font-weight: bold;">static</span> <span style="color: #df005f; font-weight: bold;">void</span> <span style="color: #d75fd7; font-weight: bold;">main</span>(<span style="color: #df005f; font-weight: bold;">String</span>[] <span style="color: #8787d7;">args</span>) {
        <span style="color: #268bd2; font-weight: bold;">try</span> {
            <span style="color: #df005f; font-weight: bold;">String</span> <span style="color: #8787d7;">srcFile</span> = <span style="color: #2aa198;">"http://127.0.0.1:8088/cluster/files/file01.txt"</span>;
            <span style="color: #df005f; font-weight: bold;">Configuration</span> <span style="color: #8787d7;">conf</span> = <span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">Configuration</span>();
            <span style="color: #df005f; font-weight: bold;">FileSystem</span> <span style="color: #8787d7;">fs</span> = FileSystem.get(URI.create(srcFile), conf);
            <span style="color: #df005f; font-weight: bold;">FSDataInputStream</span> <span style="color: #8787d7;">hdfsInStream</span> = fs.open(<span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">Path</span>(srcFile));
            <span style="color: #df005f; font-weight: bold;">BufferedOutputStream</span> <span style="color: #8787d7;">outputStream</span> = <span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">BufferedOutputStream</span>(<span style="color: #268bd2; font-weight: bold;">new</span> <span style="color: #df005f; font-weight: bold;">FileOutputStream</span>(<span style="color: #2aa198;">"C:\\files\\file01_bak.txt"</span>));
            IOUtils.copyBytes(hdfsInStream, outputStream, 4096, <span style="color: #d75fd7;">true</span>);
        } <span style="color: #268bd2; font-weight: bold;">catch</span> (<span style="color: #df005f; font-weight: bold;">IOException</span> <span style="color: #8787d7;">e</span>) {
            e.printStackTrace();
        }
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orga3d9ee7" class="outline-2">
<h2 id="orga3d9ee7">4. 通过运行 jar 包的方式验证</h2>
<div class="outline-text-2" id="text-orga3d9ee7">
<img src="./images/Hadoop-IDEA_Maven搭建项目04.png" />

<img src="./images/Hadoop-IDEA_Maven搭建项目05.png" />

<p>
生成 upload-1.0-SNAPSHOT.jar，这里的 upload 与 1.0-SNAPSHOT 都是 pom.xml 文件中配置的，可以修改。<br>
</p>

<p>
得到 jar 包后通过 <code>hadoop jar</code> 命令让 hadoop 运行 jar 包：<br>
</p>

<div class="org-src-container">
<pre class="src src-bash">hadoop jar upload-1.0-SNAPSHOT.jar com.ran.hadoop.hdfs.FileCopyFromLocal
</pre>
</div>

<p>
这里的 <code>com.ran.hadoop.hdfs.FileCopyFromLocal</code> 是全类名（包+类名），根据自己的项目更改。<br>
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-05-28 Sat 02:53</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
