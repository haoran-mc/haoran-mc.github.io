<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-05-07 Sat 21:18 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MySQL 索引有哪些分类？</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">MySQL 索引有哪些分类？</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga7bd5c2">〇、MySQL 索引都有哪些分类？</a></li>
<li><a href="#org7d575e8">一、按数据结构分类</a>
<ul>
<li><a href="#orga9eafe5">1. B+tree 与 B-tree 的对比</a></li>
<li><a href="#org4212cf3">2. B+tree 与红黑树的对比</a></li>
<li><a href="#org059a140">3. B+tree 与 Hash 的对比</a></li>
</ul>
</li>
<li><a href="#orgcfefd9e">二、按物理存储分类</a>
<ul>
<li><a href="#orgb63284c">1. 聚簇索引</a></li>
<li><a href="#org40232e8">2. 二级索引</a></li>
</ul>
</li>
<li><a href="#orgc34674a">三、按字段特性分类</a>
<ul>
<li><a href="#org25cb9af">1. 主键索引</a></li>
<li><a href="#org883e10f">2. 唯一索引</a></li>
<li><a href="#orge128849">3. 普通索引</a></li>
<li><a href="#orgde49021">4. 前缀索引</a></li>
</ul>
</li>
<li><a href="#org3f54bb2">四、按索引字段个数分类</a>
<ul>
<li><a href="#orgfca9628">1. 单列索引</a></li>
<li><a href="#org17279f9">2. 联合索引（复合索引、组合索引）</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="div-center">
	<img src="./images/MySQL索引分类.webp"/>
</div>

<div id="outline-container-orga7bd5c2" class="outline-2">
<h2 id="orga7bd5c2">〇、MySQL 索引都有哪些分类？</h2>
<div class="outline-text-2" id="text-orga7bd5c2">
<ul class="org-ul">
<li>按数据结构分类可分为：B+tree索引、Hash索引、Full-text索引。<br></li>
<li>按物理存储分类可分为：聚簇索引、二级索引（辅助索引）。<br></li>
<li>按字段特性分类可分为：主键索引、普通索引、前缀索引。<br></li>
<li>按字段个数分类可分为：单列索引、联合索引（复合索引、组合索引）。<br></li>
</ul>
</div>
</div>
<div id="outline-container-org7d575e8" class="outline-2">
<h2 id="org7d575e8">一、按数据结构分类</h2>
<div class="outline-text-2" id="text-org7d575e8">
<p>
MySQL 索引按数据结构分类可分为：B+tree索引、Hash索引、Full-text索引。<br>
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">

<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">-</th>
<th scope="col" class="org-left">InnoDB</th>
<th scope="col" class="org-left">MyISAM</th>
<th scope="col" class="org-left">Memory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">B+tree索引</td>
<td class="org-left">√</td>
<td class="org-left">√</td>
<td class="org-left">√</td>
</tr>

<tr>
<td class="org-left">Hash索引</td>
<td class="org-left">×</td>
<td class="org-left">×</td>
<td class="org-left">√</td>
</tr>

<tr>
<td class="org-left">Full-text索引</td>
<td class="org-left">√（MySQL5.6+）</td>
<td class="org-left">√</td>
<td class="org-left">×</td>
</tr>
</tbody>
</table>

<blockquote>
<p>
注：InnoDB实际上也支持Hash索引，但是InnoDB中Hash索引的创建由存储引擎引擎自动优化创建，不能人为干预是否为表创建Hash索引<br>
</p>
</blockquote>

<p>
B+tree 是MySQL中被存储引擎采用最多的索引类型。B+tree 中的 B 代表平衡（balance），而不是二叉（binary），因为 B+tree 是从最早的平衡二叉树演化而来的。下面展示 B+tree 数据结构与其他数据结构的对比。<br>
</p>
</div>
<div id="outline-container-orga9eafe5" class="outline-3">
<h3 id="orga9eafe5">1. B+tree 与 B-tree 的对比</h3>
<div class="outline-text-3" id="text-orga9eafe5">
<p>
B-tree 中的每个节点根据实际情况可以包含多条数据信息和子节点，如下图所示为一个 3 阶的 B-tree：<br>
</p>

<img src="./images/MySQL-B加树与B减树的对比01.webp" />

<p>
相对于 B-tree，B+tree 有以下两点不同：<br>
</p>

<ul class="org-ul">
<li>B+tree 非叶子节点只存储键值信息， 数据记录都存放在叶子节点中。而 B-tree 的非叶子节点也存储数据。所以 B+tree 单个节点的数据量更小，在相同的磁盘 I/O 次数下，能查询更多的节点。<br></li>
<li>B+tree 所有叶子节点之间都采用单链表连接。适合 MySQL 中常见的基于范围的顺序检索场景，而 B-tree 无法做到这一点。<br></li>
</ul>

<img src="./images/MySQL-B加树与B减树的对比02.webp" />
</div>
</div>
<div id="outline-container-org4212cf3" class="outline-3">
<h3 id="org4212cf3">2. B+tree 与红黑树的对比</h3>
<div class="outline-text-3" id="text-org4212cf3">
<img src="./images/MySQL-B加树与红黑树的对比.webp" />

<p>
<b>红黑树是一种弱平衡二叉查找树</b> 。通过对任何一条从根到叶子的路径上各个节点着色的方式的限制， <b>红黑树确保没有一条路径会比其他路径长出两倍</b> 。<br>
</p>

<p>
对于有 N 个叶子结点的 B+tree，其搜索复杂度为 <code>O(logdN)</code> ，其中 <code>d(degree)</code> 为 B+tree 的度，表示节点允许的最大子节点个数为 d 个，在实际应用当中，d 值一般是大于 100 的，即使数据量达到千万级别时 B+tree 的高度依然维持在 3-4 左右，保证 3-4 次磁盘 I/O 操作就能查询到目标数据。<br>
</p>

<p>
<b>红黑树</b> 是二叉树，节点子节点个数为两个，意味着其搜索复杂度为 <code>O(logN)</code> ，树的高度也会比 B+tree 高出不少，因此 <b>红黑树</b> 检索到目标数据所需经历的磁盘 I/O 次数更多。<br>
</p>
</div>
</div>
<div id="outline-container-org059a140" class="outline-3">
<h3 id="org059a140">3. B+tree 与 Hash 的对比</h3>
<div class="outline-text-3" id="text-org059a140">
<p>
Hash 索引结构的特殊性，其检索效率非常高，索引的检索可以一次定位，不像 B-tree 索引需要从根节点到枝节点，最后才能访问到页节点这样多次的 IO 访问，所以 Hash 索引的查询效率要远高于 B-Tree 索引。虽然 Hash 索引效率高，但是 Hash 索引本身由于其特殊性也带来了很多限制和弊端，主要有以下这些。<br>
</p>

<p>
Hash 索引仅仅能满足 <code>=</code> , <code>IN</code> 和 <code>&lt;=&gt;</code> （表示 <code>NULL</code> 安全的等价） 查询，不能使用范围查询。<br>
</p>

<p>
由于 Hash 索引比较的是进行 Hash 运算之后的 Hash 值，所以它只能用于等值的过滤，不能用于基于范围的过滤，因为经过相应的 Hash 算法处理之后的 Hash 值的大小关系，并不能保证和 Hash 运算前完全一样。<br>
</p>

<p>
Hash 索引无法适用数据的排序操作。<br>
</p>

<p>
由于 Hash 索引中存放的是经过 Hash 计算之后的 Hash 值，而且 Hash 值的大小关系并不一定和 Hash 运算前的键值完全一样，所以数据库无法利用索引的数据来避免任何排序运算；<br>
</p>

<p>
Hash 索引不能利用部分索引键查询。<br>
</p>

<p>
对于组合索引，Hash 索引在计算 Hash 值的时候是组合索引键合并后再一起计算 Hash 值，而不是单独计算 Hash 值，所以通过组合索引的前面一个或几个索引键进行查询的时候，Hash 索引也无法被利用。<br>
</p>

<p>
Hash 索引依然需要回表扫描。<br>
</p>

<p>
Hash 索引是将索引键通过 Hash 运算之后，将 Hash 运算结果的 Hash 值和所对应的行指针信息存放于一个 Hash 表中，由于不同索引键可能存在相同 Hash 值，所以即使取满足某个 Hash 键值的数据的记录条数，也无法从 Hash 索引中直接完成查询，还是要通过访问表中的实际数据进行相应的比较，并得到相应的结果。<br>
</p>

<p>
Hash 索引遇到大量 Hash 值相等的情况后性能并不一定就会比 B-tree 索引高。<br>
</p>

<p>
选择性比较低的索引键，如果创建 Hash 索引，那么将会存在大量记录指针信息存于同一个 Hash 值相关联。这样要定位某一条记录时就会非常麻烦，会浪费多次表数据的访问，而造成整体性能低下<br>
</p>

<p>
由于范围查询是 MySQL 数据库查询中常见的场景，Hash 表不适合做范围查询，它更适合做等值查询。另外 Hash 表还存在 Hash 函数选择和 Hash 值冲突等问题。因此，B+tree 索引要比 Hash 表索引有更广的适用场景。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-orgcfefd9e" class="outline-2">
<h2 id="orgcfefd9e">二、按物理存储分类</h2>
<div class="outline-text-2" id="text-orgcfefd9e">
<p>
MySQL 索引按叶子节点存储的是否为完整表数据分为： <b>聚簇索引、二级索引（辅助索引）</b> 。全表数据存储在聚簇索引中，聚簇索引以外的其他索引叫做二级索引，也叫辅助索引。<br>
</p>
</div>
<div id="outline-container-orgb63284c" class="outline-3">
<h3 id="orgb63284c">1. 聚簇索引</h3>
<div class="outline-text-3" id="text-orgb63284c">
<p>
聚簇索引的每个叶子节点存储了一行完整的表数据，叶子节点间按id列递增连接，可以方便地进行顺序检索。<br>
</p>

<img src="./images/MySQL-聚簇索引01.webp" />

<p>
InnoDB 表要求必须有聚簇索引，默认在主键字段上建立聚簇索引，在没有主键字段的情况下，表的第一个非空的唯一索引将被建立为聚簇索引，在前两者都没有的情况下，InnoDB 将自动生成一个隐式的自增 id 列，并在此列上建立聚簇索引。<br>
</p>

<p>
以 MyISAM 为存储引擎的表不存在聚簇索引。<br>
</p>

<p>
MyISAM 表中的主键索引和非主键索引的结构是一样的，索引的叶子节点不存储表数据，存放的是表数据的地址。所以，MyISAM 表可以没有主键。<br>
</p>

<img src="./images/MySQL-聚簇索引02.webp" />

<p>
MyISAM 表的数据和索引是分开存储的。MyISAM 表的主键索引和非主键索引的区别仅在于主键索引的 B+tree 上的 key 必须符合主键的限制，非主键索引 B+tree 上的 key 只要符合相应字段的特性就可以了。<br>
</p>
</div>
</div>
<div id="outline-container-org40232e8" class="outline-3">
<h3 id="org40232e8">2. 二级索引</h3>
<div class="outline-text-3" id="text-org40232e8">
<p>
二级索引的叶子节点并不存储一行完整的表数据，而是存储了聚簇索引所在列的值。<br>
</p>

<img src="./images/MySQL-二级索引01.webp" />

<p>
回表查询<br>
</p>

<p>
由于二级索引的叶子节点不存储完整的表数据，索引当通过二级索引查询到聚簇索引列值后，还需要回到聚簇索引也就是表数据本身进一步获取数据。<br>
</p>

<img src="./images/MySQL-二级索引02.webp" />

<p>
回表查询 需要额外的 B+tree 搜索过程，必然增大查询耗时。<br>
</p>

<p>
需要注意的是， <b>通过二级索引查询时，回表不是必须的过程</b> ，当 <b>SELECT 的所有字段在单个二级索引中都能够找到</b> 时，就不需要回表，MySQL 称此时的二级索引为 <b>覆盖索引</b> 或触发了 <b>索引覆盖</b> 。<br>
可以用 <code>Explain</code> 命令查看 SQL 语句的执行计划，执行计划的 <code>Extra</code> 字段中若出现 <code>Using index</code> ，表示查询触发了 <b>索引覆盖</b> 。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-orgc34674a" class="outline-2">
<h2 id="orgc34674a">三、按字段特性分类</h2>
<div class="outline-text-2" id="text-orgc34674a">
<p>
MySQL索引按字段特性分类可分为： <b>主键索引、普通索引、前缀索引</b> 。<br>
</p>
</div>
<div id="outline-container-org25cb9af" class="outline-3">
<h3 id="org25cb9af">1. 主键索引</h3>
<div class="outline-text-3" id="text-org25cb9af">
<p>
建立在主键上的索引被称为主键索引，一张数据表只能有一个主键索引，索引列值不允许有空值，通常在创建表时一起创建。<br>
</p>
</div>
</div>
<div id="outline-container-org883e10f" class="outline-3">
<h3 id="org883e10f">2. 唯一索引</h3>
<div class="outline-text-3" id="text-org883e10f">
<p>
建立在 UNIQUE 字段上的索引被称为唯一索引，一张表可以有多个唯一索引，索引列值允许为空，列值中出现多个空值不会发生重复冲突。<br>
</p>
</div>
</div>
<div id="outline-container-orge128849" class="outline-3">
<h3 id="orge128849">3. 普通索引</h3>
<div class="outline-text-3" id="text-orge128849">
<p>
建立在普通字段上的索引被称为普通索引。<br>
</p>
</div>
</div>
<div id="outline-container-orgde49021" class="outline-3">
<h3 id="orgde49021">4. 前缀索引</h3>
<div class="outline-text-3" id="text-orgde49021">
<p>
前缀索引是指对字符类型字段的前几个字符或对二进制类型字段的前几个 bytes 建立的索引，而不是在整个字段上建索引。前缀索引可以建立在类型为 char、varchar、binary、varbinary 的列上，可以大大减少索引占用的存储空间，也能提升索引的查询效率。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org3f54bb2" class="outline-2">
<h2 id="org3f54bb2">四、按索引字段个数分类</h2>
<div class="outline-text-2" id="text-org3f54bb2">
<p>
MySQL索引按字段个数分类可分为： <b>单列索引、联合索引（复合索引、组合索引）</b> 。<br>
</p>
</div>
<div id="outline-container-orgfca9628" class="outline-3">
<h3 id="orgfca9628">1. 单列索引</h3>
<div class="outline-text-3" id="text-orgfca9628">
<p>
建立在单个列上的索引被称为单列索引。<br>
</p>
</div>
</div>
<div id="outline-container-org17279f9" class="outline-3">
<h3 id="org17279f9">2. 联合索引（复合索引、组合索引）</h3>
<div class="outline-text-3" id="text-org17279f9">
<p>
建立在多个列上的索引被称为联合索引，又叫复合索引、组合索引。<br>
</p>

<div class="reference">
	<ul style="list-style: none;">
		<li><a href="https://segmentfault.com/a/1190000037683781" target="_blank">MySQL索引有哪些分类，你真的清楚吗？</a></li>
	</ul>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-05-07 20:05 Sat</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-05-07 Sat 21:18</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
