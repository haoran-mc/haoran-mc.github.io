<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-11-26 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NGINX</title>
<meta name="author" content="L.M.haoran &lt;haoran.mc@outlook.com&gt;" />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
           <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
           <script type="module" src="static/js/main.js" defer></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">NGINX</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc88f130">Nginx</a>
<ul>
<li><a href="#org1eb6afc">什么是Nginx</a></li>
<li><a href="#orge7f4831">Nginx作用</a>
<ul>
<li><a href="#orgb477982">正向代理</a></li>
<li><a href="#orge1945d9">反向代理</a></li>
<li><a href="#orga1910e9">负载均衡</a>
<ul>
<li><a href="#org9b1f24c">轮询</a></li>
<li><a href="#orgf201d8b">加权轮询</a></li>
<li><a href="#org8c2f3e6">IP hash</a></li>
</ul>
</li>
<li><a href="#orgcc7c1bc">动静分离</a></li>
</ul>
</li>
<li><a href="#org5041647">Nginx安装</a></li>
<li><a href="#orgdfe4c26">Nginx常用命令</a></li>
<li><a href="#orgf1d94d6">Nginx配置</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
#+DESCRIPTION Copyright © 2021, L.M.haoran, all rights reserved.<br>
</p>

<div id="outline-container-orgc88f130" class="outline-2">
<h2 id="orgc88f130">Nginx</h2>
<div class="outline-text-2" id="text-orgc88f130">
</div>
<div id="outline-container-org1eb6afc" class="outline-3">
<h3 id="org1eb6afc">什么是Nginx</h3>
<div class="outline-text-3" id="text-org1eb6afc">
<p>
Nginx(engin x)是一个高性能 HTTP 和反向代理 web 服务器，同时也提供了 IMAP/POP3/SMTP 服务，Nginx 其特点是占有内存少，并发能力强，Nginx 代码完全用 C 语言写成，官方数据测试表明能够支持高达 50000 个并发连接数的响应。<br>
</p>
</div>
</div>
<div id="outline-container-orge7f4831" class="outline-3">
<h3 id="orge7f4831">Nginx作用</h3>
<div class="outline-text-3" id="text-orge7f4831">
</div>
<div id="outline-container-orgb477982" class="outline-4">
<h4 id="orgb477982">正向代理</h4>
<div class="outline-text-4" id="text-orgb477982">
<p>
在中国不能访问外网，但是使用VPN后就可以连接外网，在电脑上开了一个VPN就相当于开了一个代理，这个代理会去请求能够访问外网的服务器，假设请求香港的服务器，那么香港的服务器会去请求美国的服务器，美国服务器返回数据到香港这边，香港服务器再返回当前电脑。<br>
</p>

<p>
这里是代理客户端的，反向代理是代理服务器端的。<br>
</p>
</div>
</div>
<div id="outline-container-orge1945d9" class="outline-4">
<h4 id="orge1945d9">反向代理</h4>
<div class="outline-text-4" id="text-orge1945d9">
<p>
同正向代理，但是在服务端的一个代理，这样只需要访问指定一个的域名，就能够访问不同的服务器上的数据。<br>
</p>
</div>
</div>
<div id="outline-container-orga1910e9" class="outline-4">
<h4 id="orga1910e9">负载均衡</h4>
<div class="outline-text-4" id="text-orga1910e9">
<p>
Nginx 提供的负载均衡策略有2种：内置策略和扩展策略，内置策略为轮询，加权轮询，IP hash。<br>
</p>
</div>
<div id="outline-container-org9b1f24c" class="outline-5">
<h5 id="org9b1f24c">轮询</h5>
<div class="outline-text-5" id="text-org9b1f24c">
<p>
请求依次循环访问服务器。<br>
</p>
</div>
</div>
<div id="outline-container-orgf201d8b" class="outline-5">
<h5 id="orgf201d8b">加权轮询</h5>
<div class="outline-text-5" id="text-orgf201d8b">
<p>
根据权重依次循环访问服务器。<br>
</p>
</div>
</div>
<div id="outline-container-org8c2f3e6" class="outline-5">
<h5 id="org8c2f3e6">IP hash</h5>
<div class="outline-text-5" id="text-org8c2f3e6">
<p>
Nginx 默认带的操作，但是不建议使用 Nginx，建议使用 Redis。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-orgcc7c1bc" class="outline-4">
<h4 id="orgcc7c1bc">动静分离</h4>
<div class="outline-text-4" id="text-orgcc7c1bc">
<p>
在软件开发中，有些请求是需要后台处理的，有些请求是不需要经过后台处理的（如：CSS, html, jpg, js 等等文件），这些不需要后台处理的文件称为静态文件，让动态网站的动态网页根据一定规则把不变的资源和经常变的资源区分开来，动静资源做好拆分之后，可以根据静态资源的特点将其作为缓存操作，提高资源响应速度。<br>
</p>

<p>
静态的自己就可以解决，动态的就使用 web server 比如 tomcat。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org5041647" class="outline-3">
<h3 id="org5041647">Nginx安装</h3>
<div class="outline-text-3" id="text-org5041647">
<div class="org-src-container">
<pre class="src src-bash">yum install nginx
whereis nginx
</pre>
</div>

<p>
nginx 下载目录下有 sbin 是二进制运行文件，conf 是配置文件，里面的 nginx.conf 可以配置。<br>
</p>
</div>
</div>
<div id="outline-container-orgdfe4c26" class="outline-3">
<h3 id="orgdfe4c26">Nginx常用命令</h3>
<div class="outline-text-3" id="text-orgdfe4c26">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #ff6ac1;">cd</span> /usr/local/nginx/sbin
./nginx            <span style="color: #606580;"># </span><span style="color: #606580;">&#21551;&#21160;</span>
./nginx -s stop    <span style="color: #606580;"># </span><span style="color: #606580;">&#20572;&#27490;</span>
./nginx -s quit    <span style="color: #606580;"># </span><span style="color: #606580;">&#23433;&#20840;&#36864;&#20986;</span>
./nginx -s reload  <span style="color: #606580;"># </span><span style="color: #606580;">&#37325;&#26032;&#21152;&#36733;&#37197;&#32622;&#25991;&#20214;</span>
ps aux|grep nginx  <span style="color: #606580;"># </span><span style="color: #606580;">&#26597;&#30475;nginx&#36827;&#31243;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf1d94d6" class="outline-3">
<h3 id="orgf1d94d6">Nginx配置</h3>
<div class="outline-text-3" id="text-orgf1d94d6">
<div class="org-src-container">
<pre class="src src-conf"><span style="color: #606580;"># </span><span style="color: #606580;">&#20840;&#23616;&#37197;&#32622;</span>

<span style="color: #9aedfe;">events</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">&#26368;&#22823;&#36827;&#31243;&#25968;</span>
}


<span style="color: #9aedfe;">http</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">htpp&#30340;&#20840;&#23616;&#37197;&#32622;</span>
<span style="color: #606580;"># </span><span style="color: #606580;">&#38745;&#24577;&#31649;&#29702;</span>

<span style="color: #606580;"># </span><span style="color: #606580;">&#36825;&#37324;&#30340;&#21517;&#23383;&#26159;&#20219;&#24847;&#23450;&#30340;&#65292;&#29992;&#26469;&#32473;&#19979;&#38754;&#30340;&#20195;&#29702;&#20351;&#29992;</span>
<span style="color: #9aedfe;">upstream random_name</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">&#36127;&#36733;&#22343;&#34913;</span>
<span style="color: #606580;"># </span><span style="color: #606580;">&#26381;&#21153;&#22120;&#36164;&#28304;</span>
<span style="color: #ff5c57;">server 127.0.0.1.8080 weight</span>=1;
<span style="color: #ff5c57;">server 127.0.0.1.8081 weight</span>=1;
}

<span style="color: #606580;"># </span><span style="color: #606580;">&#29992;&#26469;&#37197;&#32622;&#19981;&#21516;&#30340;&#26381;&#21153;</span>
<span style="color: #9aedfe;">server</span> {
listen 80;
server_name localhost;
<span style="color: #606580;"># </span><span style="color: #606580;">&#20195;&#29702;</span>

<span style="color: #606580;"># </span><span style="color: #606580;">&#21453;&#21521;&#20195;&#29702;&#37096;&#20998;</span>
<span style="color: #9aedfe;">location /</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">xxxx</span>
root html;
index index.html index.htm;
proxy_pass http://random_name;
}

<span style="color: #9aedfe;">location /</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">&#38745;&#24577;&#25991;&#20214;&#26681;&#30446;&#24405;</span>
<span style="color: #606580;"># </span><span style="color: #606580;">xxxx</span>
}
}

<span style="color: #606580;"># </span><span style="color: #606580;">&#29992;&#26469;&#37197;&#32622;&#19981;&#21516;&#30340;&#26381;&#21153;</span>
<span style="color: #9aedfe;">server</span> {
listen 443;
server_name localhost;
<span style="color: #606580;"># </span><span style="color: #606580;">&#20195;&#29702;</span>
}
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-conf"><span style="color: #606580;"># </span><span style="color: #606580;">&#20840;&#23616;&#37197;&#32622;</span>

<span style="color: #9aedfe;">events</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">&#26368;&#22823;&#36827;&#31243;&#25968;</span>
}


<span style="color: #9aedfe;">http</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">htpp&#30340;&#20840;&#23616;&#37197;&#32622;</span>
<span style="color: #606580;"># </span><span style="color: #606580;">&#38745;&#24577;&#31649;&#29702;</span>

<span style="color: #606580;"># </span><span style="color: #606580;">&#36825;&#37324;&#30340;&#21517;&#23383;&#26159;&#20219;&#24847;&#23450;&#30340;&#65292;&#29992;&#26469;&#32473;&#19979;&#38754;&#30340;&#20195;&#29702;&#20351;&#29992;</span>
<span style="color: #9aedfe;">upstream random_name</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">&#36127;&#36733;&#22343;&#34913;</span>
<span style="color: #606580;"># </span><span style="color: #606580;">&#26381;&#21153;&#22120;&#36164;&#28304;</span>
<span style="color: #ff5c57;">server 127.0.0.1.8080 weight</span>=1;
<span style="color: #ff5c57;">server 127.0.0.1.8081 weight</span>=1;
}

<span style="color: #606580;"># </span><span style="color: #606580;">&#29992;&#26469;&#37197;&#32622;&#19981;&#21516;&#30340;&#26381;&#21153;</span>
<span style="color: #9aedfe;">server</span> {
listen 80;
server_name localhost;
<span style="color: #606580;"># </span><span style="color: #606580;">&#20195;&#29702;</span>

<span style="color: #606580;"># </span><span style="color: #606580;">&#21453;&#21521;&#20195;&#29702;&#37096;&#20998;</span>
<span style="color: #9aedfe;">location /</span> {
<span style="color: #606580;"># </span><span style="color: #606580;">xxxx</span>
root html;
index index.html index.htm;
proxy_pass http://random_name;
}
}
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2021-05-06 17:05 四</p>
<p class="author">Author: L.M.haoran &lt;haoran.mc@outlook.com&gt;</p>
<p class="date">Created: 2022-11-26</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
