<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-05-28 Sat 23:43 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HTTP请求行、请求头、请求体详解</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">HTTP请求行、请求头、请求体详解</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc95f6bf">HTTP 请求报文</a>
<ul>
<li><a href="#org5d0fa55">HTTP 请求报文结构</a></li>
<li><a href="#orgf6f45b4">HTTP 请求报文头属性</a>
<ul>
<li><a href="#orgab7d09d">常见的 HTTP 请求报文头属性</a>
<ul>
<li><a href="#org44c42d4">Accept</a></li>
<li><a href="#org86c9532">Cookie</a></li>
<li><a href="#org9118bea">Referer</a></li>
<li><a href="#orga843c0a">Cache-Control</a></li>
</ul>
</li>
<li><a href="#org0c08524">其他请求报文头属性</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgbde4467">HTTP 响应报文</a>
<ul>
<li><a href="#org78bbf6c">HTTP 响应报文结构</a></li>
<li><a href="#orgd0a95be">HTTP 响应状态码</a>
<ul>
<li><a href="#orgbf2fa50">常见的状态码</a></li>
</ul>
</li>
<li><a href="#org262df4d">HTTP 响应报文头属性</a>
<ul>
<li><a href="#org5731a21">常见的 HTTP 响应报文头属性</a>
<ul>
<li><a href="#org1deda50">Cache-Control</a></li>
<li><a href="#orgc01abd1">ETag</a></li>
<li><a href="#org83c3614">Location</a></li>
<li><a href="#org67da253">Set-Cookie</a></li>
</ul>
</li>
<li><a href="#org25a0ed1">其他响应报文头属性</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc95f6bf" class="outline-2">
<h2 id="orgc95f6bf">HTTP 请求报文</h2>
<div class="outline-text-2" id="text-orgc95f6bf">
</div>
<div id="outline-container-org5d0fa55" class="outline-3">
<h3 id="org5d0fa55">HTTP 请求报文结构</h3>
<div class="outline-text-3" id="text-org5d0fa55">
<p>
HTTP 请求报文由 3 部分组成（请求行 + 请求头 + 请求体）：<br>
</p>

<img src="./images/HTTP请求报文结构.jpg" />

<p>
下面是一个实际的请求报文：<br>
</p>

<img src="./images/HTTP请求报文.jpg" />

<ul class="org-ul">
<li>①是请求方法， <i>GET</i> 和 <i>POST</i> 是最常见的 HTTP 方法，除此以外还包括 <i>DELETE</i> 、 <i>HEAD</i> 、 <i>OPTIONS</i> 、 <i>PUT</i> 、 <i>TRACE</i> 。不过，当前的大多数浏览器只支持 <i>GET</i> 和 <i>POST</i> ；<br></li>
<li>②为请求对应的 URL 地址，它和报文头的 Host 属性组成完整的请求 URL；<br></li>
<li>③是协议名称及版本号；<br></li>
<li>④是 HTTP 的报文头，报文头包含若干个属性，格式为 "属性名:属性值"，服务端据此获取客户端的信息；<br></li>
<li>⑤是报文体，它将一个页面表单中的组件值通过 param1=value1&amp;param2=value2 的键值对形式编码成一个格式化串，它承载多个请求参数的数据。不但报文体可以传递请求参数，请求 URL 也可以通过类似于 "/chapter15/user.html? param1=value1&amp;param2=value2" 的方式传递请求参数；<br></li>
</ul>

<p>
对照上面的请求报文，我们把它进一步分解，你可以看到一幅更详细的结构图：<br>
</p>

<img src="./images/更详细的HTTP请求报文结构图.jpg" />
</div>
</div>
<div id="outline-container-orgf6f45b4" class="outline-3">
<h3 id="orgf6f45b4">HTTP 请求报文头属性</h3>
<div class="outline-text-3" id="text-orgf6f45b4">
</div>
<div id="outline-container-orgab7d09d" class="outline-4">
<h4 id="orgab7d09d">常见的 HTTP 请求报文头属性</h4>
<div class="outline-text-4" id="text-orgab7d09d">
</div>
<div id="outline-container-org44c42d4" class="outline-5">
<h5 id="org44c42d4">Accept</h5>
<div class="outline-text-5" id="text-org44c42d4">
<p>
请求报文可通过一个 "Accept" 报文头属性告诉服务端，客户端接受什么类型的响应。<br>
</p>

<p>
如下报文头相当于告诉服务端，客户端能够接受的响应类型仅为纯文本数据啊，图片、视频之类的数据无法处理。<br>
</p>

<pre class="example">
Accept:text/plain  
</pre>

<p>
Accept 属性的值可以为一个或多个 MIME 类型的值，关于 MIME 类型，大家请参考： <a href="http://en.wikipedia.org/wiki/MIME_type">http://en.wikipedia.org/wiki/MIME_type</a>  <br>
</p>
</div>
</div>
<div id="outline-container-org86c9532" class="outline-5">
<h5 id="org86c9532">Cookie</h5>
<div class="outline-text-5" id="text-org86c9532">
<p>
客户端的 Cookie 就是通过这个报文头属性传给服务端的：<br>
</p>

<pre class="example">
Cookie: $Version=1; Skin=new;jsessionid=5F4771183629C9834F8382E23BE13C4C  
</pre>
</div>
</div>
<div id="outline-container-org9118bea" class="outline-5">
<h5 id="org9118bea">Referer</h5>
<div class="outline-text-5" id="text-org9118bea">
<p>
表示这个请求是从哪个URL过来的，假如你通过 google 搜索出一个商家的广告页面，你对这个广告页面感兴趣，鼠标一点发送一个请求报文到商家的网站，这个请求报文的 Referer 报文头属性值就是 <a href="http://www.google.com">http://www.google.com</a>。<br>
</p>

<p>
很多貌似神奇的网页监控软件（如著名的  我要啦 ），只要在你的网页上放上一段 JavaScript，就可以帮你监控流量，全国访问客户的分布情况等报表和图表，其原理就是通过这个 Referer 及其它一些 HTTP 报文头工作的。<br>
</p>
</div>
</div>
<div id="outline-container-orga843c0a" class="outline-5">
<h5 id="orga843c0a">Cache-Control</h5>
<div class="outline-text-5" id="text-orga843c0a">
<p>
对缓存进行控制，如一个请求希望响应返回的内容在客户端要被缓存一年，或不希望被缓存就可以通过这个报文头达到目的。<br>
</p>

<p>
如以下设置，相当于让服务端将对应请求返回的响应内容不要在客户端缓存：<br>
</p>

<pre class="example">
Cache-Control: no-cache  
</pre>
</div>
</div>
</div>
<div id="outline-container-org0c08524" class="outline-4">
<h4 id="org0c08524">其他请求报文头属性</h4>
<div class="outline-text-4" id="text-org0c08524">
<p>
参见： <a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields">http://en.wikipedia.org/wiki/List_of_HTTP_header_fields</a>  <br>
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgbde4467" class="outline-2">
<h2 id="orgbde4467">HTTP 响应报文</h2>
<div class="outline-text-2" id="text-orgbde4467">
</div>
<div id="outline-container-org78bbf6c" class="outline-3">
<h3 id="org78bbf6c">HTTP 响应报文结构</h3>
<div class="outline-text-3" id="text-org78bbf6c">
<p>
HTTP 的响应报文也由三部分组成（相应行 + 响应头 + 响应体）：<br>
</p>

<img src="./images/HTTP响应报文结构.jpg" />

<p>
以下是一个实际的 HTTP 响应报文：<br>
</p>

<img src="./images/HTTP响应报文.jpg" style="padding: 10px" />

<ul class="org-ul">
<li>①报文协议及版本；<br></li>
<li>②状态码及状态描述；<br></li>
<li>③响应报文头，也是由多个属性组成；<br></li>
<li>④响应报文体，即我们真正要的“干货”；<br></li>
</ul>
</div>
</div>
<div id="outline-container-orgd0a95be" class="outline-3">
<h3 id="orgd0a95be">HTTP 响应状态码</h3>
<div class="outline-text-3" id="text-orgd0a95be">
<p>
和请求报文相比，响应报文多了一个“响应状态码”，它以“清晰明确”的语言告诉客户端本次请求的处理结果。<br>
</p>

<p>
HTTP 的响应状态码由 5 段组成：<br>
</p>

<pre class="example">
1xx 消息，一般是告诉客户端，请求已经收到了，正在处理，别急...
2xx 处理成功，一般表示：请求收悉、我明白你要的、请求已受理、已经处理完成等信息；
3xx 重定向到其它地方。它让客户端再发起一个请求以完成整个处理；
4xx 处理发生错误，责任在客户端，如客户端请求一个不存在的资源，客户端未被授权，禁止访问等；
5xx 处理发生错误，责任在服务端，如服务端抛出异常，路由出错，HTTP 版本不支持等；
</pre>
</div>
<div id="outline-container-orgbf2fa50" class="outline-4">
<h4 id="orgbf2fa50">常见的状态码</h4>
<div class="outline-text-4" id="text-orgbf2fa50">
<dl class="org-dl">
<dt>200 OK</dt><dd>你最希望看到的，即处理成功！<br></dd>

<dt>303 See Other</dt><dd>我把你 redirect 到其它的页面，目标的 URL 通过响应报文头的 Location 告诉你；<br></dd>
<dt>304 Not Modified</dt><dd>告诉客户端，你请求的这个资源至你上次取得后，并没有更改，你直接用你本地的缓存吧，我很忙哦，你能不能少来烦我啊；<br></dd>
<dt>404 Not Found</dt><dd>你最不希望看到的，即找不到页面。如你在 google 上找到一个页面，点击这个链接返回 404，表示这个页面已经被网站删除了，google 那边的记录只是美好的回忆；<br></dd>
<dt>500 Internal Server Error</dt><dd>看到这个错误，你就应该查查服务端的日志了，肯定抛出了一堆异常，别睡了，起来改 BUG 去吧；<br></dd>
</dl>

<p>
其它的状态码参见： <a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a>  <br>
</p>
</div>
</div>
</div>
<div id="outline-container-org262df4d" class="outline-3">
<h3 id="org262df4d">HTTP 响应报文头属性</h3>
<div class="outline-text-3" id="text-org262df4d">
</div>
<div id="outline-container-org5731a21" class="outline-4">
<h4 id="org5731a21">常见的 HTTP 响应报文头属性</h4>
<div class="outline-text-4" id="text-org5731a21">
</div>
<div id="outline-container-org1deda50" class="outline-5">
<h5 id="org1deda50">Cache-Control</h5>
<div class="outline-text-5" id="text-org1deda50">
<p>
响应输出到客户端后，服务端通过该报文头属告诉客户端如何控制响应内容的缓存。<br>
</p>

<p>
下面的设置让客户端对响应内容缓存 3600 秒，也即在 3600 秒内，如果客户再次访问该资源，直接从客户端的缓存中返回内容给客户，不要再从服务端获取 （当然，这个功能是靠客户端实现的，服务端只是通过这个属性提示客户端“应该这么做”，做不做，还是决定于客户端，如果是自己宣称支持HTTP的客户端，则就应该这样实现） 。<br>
</p>

<pre class="example">
Cache-Control: max-age=3600  
</pre>
</div>
</div>
<div id="outline-container-orgc01abd1" class="outline-5">
<h5 id="orgc01abd1">ETag</h5>
<div class="outline-text-5" id="text-orgc01abd1">
<p>
一个代表响应服务端资源（如页面）版本的报文头属性，如果某个服务端资源发生变化了，这个 ETag 就会相应发生变化。它是 Cache-Control 的有益补充，可以让客户端“更智能”地处理什么时候要从服务端取资源，什么时候可以直接从缓存中返回响应。<br>
</p>

<p>
关于 ETag 的说明，你可以参见： <a href="http://en.wikipedia.org/wiki/HTTP_ETag">http://en.wikipedia.org/wiki/HTTP_ETag</a> 。<br>
</p>

<pre class="example">
ETag: "737060cd8c284d8af7ad3082f209582d"  
</pre>
</div>
</div>
<div id="outline-container-org83c3614" class="outline-5">
<h5 id="org83c3614">Location</h5>
<div class="outline-text-5" id="text-org83c3614">
<p>
我们在 JSP 中让页面 Redirect 到一个某个 A 页面中，其实是让客户端再发一个请求到 A 页面，这个需要 Redirect 到的 A 页面的 URL，其实就是通过响应报文头的 Location 属性告知客户端的，如下的报文头属性，将使客户端 redirect 到 iteye 的首页中：<br>
</p>

<pre class="example">
Location: http://www.iteye.com  
</pre>
</div>
</div>
<div id="outline-container-org67da253" class="outline-5">
<h5 id="org67da253">Set-Cookie</h5>
<div class="outline-text-5" id="text-org67da253">
<p>
服务端可以设置客户端的 Cookie，其原理就是通过这个响应报文头属性实现的：<br>
</p>

<pre class="example">
Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1  
</pre>
</div>
</div>
</div>
<div id="outline-container-org25a0ed1" class="outline-4">
<h4 id="org25a0ed1">其他响应报文头属性</h4>
<div class="outline-text-4" id="text-org25a0ed1">
<p>
更多其它的HTTP响应头报文，参见： <a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields">http://en.wikipedia.org/wiki/List_of_HTTP_header_fields</a>   <br>
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-05-28 Sat 23:43</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
