<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2023-02-01 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SUBMODULE</title>
<meta name="author" content="Haoran Liu" />
<meta name="description" content="Copyright © 2022, Haoran Liu, all rights reserved." />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
           <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
           <script type="module" src="static/js/main.js" defer></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">SUBMODULE</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org208d102">添加 submodule</a></li>
<li><a href="#org6385db2">删除 submodule</a></li>
<li><a href="#orgf4a9f2f">拉取子模块</a></li>
</ul>
</div>
</div>

<div id="outline-container-org208d102" class="outline-2">
<h2 id="org208d102">添加 submodule</h2>
<div class="outline-text-2" id="text-org208d102">
<ul class="org-ul">
<li>git submodule add git@github.com:haoran-mc/haoran-mc.github.io.git Org/site/public<br></li>
</ul>
</div>
</div>
<div id="outline-container-org6385db2" class="outline-2">
<h2 id="org6385db2">删除 submodule</h2>
<div class="outline-text-2" id="text-org6385db2">
<dl class="org-dl">
<dt>rm -rf 子模块目录</dt><dd>删除子模块目录及源码<br></dd>
<dt>vi .gitmodules</dt><dd>删除项目目录下.gitmodules文件中子模块相关条目<br></dd>
<dt>vi .git/config</dt><dd>删除配置项中子模块相关条目<br></dd>
<dt>rm .git/module/*</dt><dd>删除模块下的子模块目录，每个子模块对应一个目录，注意只删除对应的子模块目录即可<br></dd>
<dt>git rm &#x2013;cached</dt><dd>子模块名称<br></dd>
</dl>
</div>
</div>
<div id="outline-container-orgf4a9f2f" class="outline-2">
<h2 id="orgf4a9f2f">拉取子模块</h2>
<div class="outline-text-2" id="text-orgf4a9f2f">
<p>
如果要 <code>clone</code> 一个包含子模块的项目，需要给 <code>git clone</code> 命令最后加上 <code>--recurse-submodules</code> 或者 <code>--recursive</code> 参数（否则只会下载一个空的子模块文件）：<br>
</p>

<pre class="example" id="org2e20e6c">
git clone https://github.com/yyy/xxx.git --recursive
</pre>

<p>
如果克隆时忘记加参数：<br>
</p>

<ol class="org-ol">
<li><p>
初始化子模块相关配置<br>
</p>

<pre class="example" id="orgd5ffc81">
git submodule init
</pre>

<p>
这句会在 <code>config</code> 中加入下面两行内容：<br>
</p>

<pre class="example" id="orgc9cf280">
submodule.xxx.url=git@github.com:yyy/xxx.git
submodule.xxx.active=true
</pre></li>

<li><p>
拉取子模块仓库中的文件<br>
</p>

<pre class="example" id="org5c92539">
git submodule update
</pre></li>
</ol>

<p>
也可以将两步命令合并为一步：<br>
</p>

<pre class="example" id="org24cc3fd">
git submodule update --init
</pre>

<p>
拉取层层嵌套的子模块：<br>
</p>

<pre class="example" id="org8557bb0">
git submodule update --init --recursive
</pre>

<p>
之前 clone 时加参数不过是自动执行初始化配置并拉取子模块（甚至嵌套的子模块）中的文件罢了；<br>
</p>

<p>
命令默认拉取主分支（master），想要修改这个默认拉取分支可以修改 .gitmodules 文件中子模块对应的 branch 值，或者执行：<br>
</p>

<pre class="example" id="orgc9a7758">
git config submodule.xxx.branch dev
</pre>

<p>
或者执行同时将配置写入文件，这样其他人拉取父项目也会获取该配置：<br>
</p>

<pre class="example" id="orga21525e">
git config -f .gitmodules submodule.xxx.branch dev
</pre>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-09-19 13:09 一</p>
<p class="author">Author: Haoran Liu</p>
<p class="date">Created: 2023-02-01</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
