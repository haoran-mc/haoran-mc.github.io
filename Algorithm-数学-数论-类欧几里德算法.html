<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2021-10-11 Mon 00:12 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>类欧几里德算法</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2021, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">类欧几里德算法</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge751dd7">类欧几里德算法</a>
<ul>
<li><a href="#org255f952">代码实现</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orge751dd7" class="outline-2">
<h2 id="orge751dd7">类欧几里德算法</h2>
<div class="outline-text-2" id="text-orge751dd7">
<p>
又叫扩展欧几里德算法，用来解决这样一个问题：给定两个非零整数 \(a, b\)，求一组整数解 \((x, y)\) 使得 \(ax + by = gcd(a, b)\)，其中 \(gcd(a, b)\) 表示 \(a\) 和 \(b\) 的 <a href="Algorithm-数学-数论-最大公约数.html">最大公约数</a>，通过 <a href="Algorithm-数学-数论-裴蜀定理.html">裴蜀定理</a> 可知解一定存在。<br>
</p>

<p>
回忆欧几里德算法，如下面代码所示，它总是把 \(gcd(a, b)\) 转化为求解 \(gcd(b, a \% b)\)，而当 \(b\) 变为 \(0\) 时返回 \(a\)，此时 \(a\) 就等于 \(gcd(a, b)\)，也就是说，欧几里德算法结束的时候变量 \(a\) 中存放的是 \(gcd(a, b)\)，变量 \(b\) 中存放的是 \(0\)，因此此时显然有 \(a * + b * 0 = gcd(a, b)\) 成立，所以此时 \(x = 1, y = 0\)。<br>
</p>

<div class="org-src-container">
<pre class="src src-cpp"><span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">gcd</span>(<span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">a</span>, <span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">b</span>) {
    <span style="color: #BD93F9;">if</span> (b == <span style="color: #009F9F;">0</span>)
        <span style="color: #BD93F9;">return</span> a;
    <span style="color: #BD93F9;">else</span>
        <span style="color: #BD93F9;">return</span> gcd(b, a % b);
}
</pre>
</div>

<p>
不妨利用上面欧几里德算法的过程来计算 \(x\) 和 \(y\)，目前已知的是递归边界成立时为 \(x = 1，y = 0\)，需要想办法反推出最初始的 \(x\) 和 \(y\)。<br>
</p>

<p>
当计算 \(gcd(a, b)\) 时，有 \(ax_1 + by_1 = gcd(a, b)\) 成立，而在下一步计算 \(gcd(b, a \% b)\) 时，又有 \(bx_2 + (a \% b)y_2 = gcd(a, b)\) 成立，因此 \(ax_1 + by_1 = bx_2 + (a \% b)y_2\)，又因为 \(a \% b = a - (a / b) * b\)，因此 \(ax_1 + by_1 = bx_2 + (a - (a / b) * b)y_2\)，即 \(ax_1 + by_1 = ay_2 + b(x_2 - (a / b)y_2)\)，对比等号两边可得到递推公式：<br>
</p>

<p>
\[\begin{cases}x_1 = y_2\\ y_1 = x_2 - (a / b)y_2 \end{cases}\]<br>
</p>

<p>
这样就可以通过 \(x_2\) 和 \(y_2\) 来反推 \(x_1\) 和 \(y_1\) 了。<br>
</p>
</div>
<div id="outline-container-org255f952" class="outline-3">
<h3 id="org255f952">代码实现</h3>
<div class="outline-text-3" id="text-org255f952">
<div class="org-src-container">
<pre class="src src-cpp"><span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">exgcd</span>(<span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">a</span>, <span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">b</span>, <span style="color: #AFAFAF;">int</span> &amp;<span style="color: #AFAFAF;">x</span>, <span style="color: #AFAFAF;">int</span> &amp;<span style="color: #AFAFAF;">y</span>) {
    <span style="color: #BD93F9;">if</span> (!b) {
        x = <span style="color: #009F9F;">1</span>, y = <span style="color: #009F9F;">0</span>;
        <span style="color: #BD93F9;">return</span> a;
    }
    <span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">d</span> = exgcd(b, a % b, y, x);
    y -= a / b * x;
    <span style="color: #BD93F9;">return</span> gcd(b, a % b);
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2021-10-09 18:10 Sat</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2021-10-11 Mon 00:12</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
