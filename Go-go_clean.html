<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-04-01 Fri 10:28 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>go clean</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2021, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">go clean</h1>
<p>
执行 <code>go clean</code> 命令会删除掉执行其它命令时产生的一些文件和目录，包括：<br>
</p>

<ol class="org-ol">
<li>在使用 <code>go build</code> 命令时在当前代码包下生成的与包名同名或者与 Go 源码文件同名的可执行文件。在 Windows 下，则是与包名同名或者 Go 源码文件同名且带有“.exe”后缀的文件。<br></li>
<li>在执行 <code>go test</code> 命令并加入 <code>-c</code> 标记时在当前代码包下生成的以包名加“.test”后缀为名的文件。在 Windows 下，则是以包名加“.test.exe”后缀为名的文件。我们会在后面专门介绍 <code>go test</code> 命令。<br></li>
<li>如果执行 <code>go clean</code> 命令时带有标记 <code>-i</code> ，则会同时删除安装当前代码包时所产生的结果文件。如果当前代码包中只包含库源码文件，则结果文件指的就是在工作区的pkg目录的相应目录下的归档文件。如果当前代码包中只包含一个命令源码文件，则结果文件指的就是在工作区的bin目录下的可执行文件。<br></li>
<li>还有一些目录和文件是在编译Go或C源码文件时留在相应目录中的。包括：“_obj”和“_test”目录，名称为“_testmain.go”、“test.out”、“build.out”或“a.out”的文件，名称以“.5”、“.6”、“.8”、“.a”、“.o”或“.so”为后缀的文件。这些目录和文件是在执行 <code>go build</code> 命令时生成在临时目录中的。如果你忘记了这个临时目录是怎么回事儿，可以再回顾一下前面关于 <code>go build</code> 命令的介绍。临时目录的名称以 <code>go-build</code> 为前缀。<br></li>
<li>如果执行 <code>go clean</code> 命令时带有标记 <code>-r</code> ，则还包括当前代码包的所有依赖包的上述目录和文件。<br></li>
</ol>

<p>
我们再以 goc2p 项目的 <code>logging</code> 为例。为了能够反复体现每个标记的作用，我们会使用标记 <code>n</code> 。使用标记 <code>-n</code> 会让命令在执行过程中打印用到的系统命令，但不会真正执行它们。如果想既打印命令又执行命令则需使用标记 <code>-x</code> 。现在我们来试用一下 <code>go clean</code> 命令：<br>
</p>

<div class="org-src-container">
<pre class="src src-bash">hc@ubt:~/golang/goc2p/src$ go clean -x logging   
<span style="color: #268bd2;">cd</span> /home/hc/golang/goc2p/src/logging
rm -f logging logging.exe logging.test logging.test.exe
</pre>
</div>

<p>
现在，我们加上标记 <code>-i</code> ：<br>
</p>

<div class="org-src-container">
<pre class="src src-bash">hc@ubt:~/golang/goc2p/src$ go clean -x -i logging   
<span style="color: #268bd2;">cd</span> /home/hc/golang/goc2p/src/logging
rm -f logging logging.exe logging.test logging.test.exe
rm -f /home/hc/golang/goc2p/pkg/linux_386/logging.a
</pre>
</div>

<p>
如果再加上标记 <code>-r</code> 又会打印出哪些命令呢？请读者自己试一试吧。<br>
</p>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2021-09-22 04:09 三</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-04-01 Fri 10:28</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
