<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-06-03 Fri 03:14 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SHELL</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">SHELL</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org185af61">什么是 shell 脚本</a></li>
<li><a href="#orgaef1e04">变量</a>
<ul>
<li><a href="#org43a7b11">定义变量</a></li>
<li><a href="#orga2b45fb">使用变量</a></li>
<li><a href="#org7e7f2e1">重定义变量</a></li>
</ul>
</li>
<li><a href="#orgbed1f59">shell 脚本实例</a>
<ul>
<li><a href="#orgd17286d">自动 git push</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org185af61" class="outline-2">
<h2 id="org185af61">什么是 shell 脚本</h2>
<div class="outline-text-2" id="text-org185af61">
<p>
先来看个例子：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #008787; background-color: #262626;">#</span><span style="color: #008787; background-color: #262626;">!/bin/</span><span style="color: #268bd2; font-weight: bold;">sh</span>
<span style="color: #268bd2;">cd</span> ~
mkdir shell_tut
<span style="color: #268bd2;">cd</span> shell_tut

<span style="color: #268bd2; font-weight: bold;">for</span> ((<span style="color: #8787d7;">i</span>=0; i&lt;10; i++)); <span style="color: #268bd2; font-weight: bold;">do</span>
    touch test_$<span style="color: #8787d7;">i</span>.txt
<span style="color: #268bd2; font-weight: bold;">done</span>
</pre>
</div>

<ul class="org-ul">
<li>第1行：指定脚本解释器，这里是用/bin/sh做解释器的<br></li>
<li>第2行：切换到当前用户的home目录<br></li>
<li>第3行：创建一个目录shell_tut<br></li>
<li>第4行：切换到shell_tut目录<br></li>
<li>第5行：循环条件，一共循环10次<br></li>
<li>第6行：创建一个test_0…9.txt文件<br></li>
<li>第7行：循环体结束<br></li>
</ul>

<p>
mkdir, touch都是系统自带的程序，一般在/bin或者/usr/bin目录下。for, do, done是sh脚本语言的关键字。<br>
</p>
</div>
</div>
<div id="outline-container-orgaef1e04" class="outline-2">
<h2 id="orgaef1e04">变量<a id="orge227e56"></a></h2>
<div class="outline-text-2" id="text-orgaef1e04">
</div>
<div id="outline-container-org43a7b11" class="outline-3">
<h3 id="org43a7b11">定义变量</h3>
<div class="outline-text-3" id="text-org43a7b11">
<p>
变量的设置规则：<br>
</p>

<ul class="org-ul">
<li>变量与变量内容以一个等号 "=" 来链接，如： <code>your_name=Alice</code> ，定义变量时，变量名不加美元符号（$）<br></li>
<li><p>
等号两边不能直接接空白字符，如下所示为错误：<br>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8787d7;">your_name</span> = Alice
<span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&#25110;</span>
<span style="color: #8787d7;">your_name</span>=Alice Bob
</pre>
</div></li>
<li>变量名称只能是英文字母与数字，但是开头字符不能是数字， <b>错误的变量名</b> ： <code>1your_name=Alice</code><br></li>
<li>变量内容若有空白字符可使用双引号 <code>"</code> 或单引号 <code>'</code> 将变量内容结合起来，但<br>
<ul class="org-ul">
<li><p>
双引号内的特殊字符如 <code>$</code> 等，可以保有原本的特性，如下所示：<br>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8787d7;">var</span>=<span style="color: #2aa198;">"lang is $LANG"</span>
<span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&#21017; echo $var &#21487;&#24471; lang is zh_TW.UTF-8</span>
</pre>
</div></li>
<li><p>
单引号内的特殊字符则仅为一般字符（纯文本），如下所示：<br>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8787d7;">var</span>=<span style="color: #2aa198;">'lang is $LANG'</span>
<span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&#21017; echo $var &#21487;&#24471; lang is $LANG</span>
</pre>
</div></li>
<li>可用跳脱字符 <code>\</code> 将特殊符号（如 [Enter], $, \, 空白字符, '等）变成一般字符，如： <code>your_name=Alice\ Bob</code><br></li>
</ul></li>
<li><p>
在一串指令的执行中，还需要借由其他额外的指令所提供的信息时，可以使用反单引号 <code>`</code> 或 <code>$</code><br>
</p>
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #268bd2;">cd</span> /lib/modules/<span style="color: #d75fd7;">`uname -r`</span>/kernel
<span style="color: #268bd2;">cd</span> /lib/modules/$(uname -r)/kernel
</pre>
</div>

<p>
<span class="underline">建议记住 <code>$()</code> 这种形式的，和数学中加减乘除的括号相似。</span><br>
</p></li>
<li>若该变量为扩增变量内容时，则可用 "$变量名称" 或 ${变量} 累加内容，如： <code>PATH="$PATH":/home/bin</code> 或 <code>PATH=${PATH}:/home/bin</code><br></li>
<li><p>
若该变量需要在其他子程序执行，则需要以 export 来使变量变成环境变量： <code>export PATH</code><br>
</p>

<div class="org-src-container">
<pre class="src src-bash">$ <span style="color: #8787d7;">your_name</span>=<span style="color: #2aa198;">"Alice"</span>
$ bash              <span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&lt;== &#36827;&#20837;&#23376;&#31243;&#24207;</span>
$ echo $<span style="color: #8787d7;">your_name</span>   <span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&lt;== &#22312;&#23376;&#31243;&#24207;&#19979;&#36755;&#20986;&#29238;&#31243;&#24207;&#23450;&#20041;&#30340;&#21464;&#37327;&#65292;&#27809;&#26377;&#36755;&#20986;</span>
$ exit              <span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&lt;== &#36864;&#20986;&#23376;&#31243;&#24207;</span>
$ export your_name  <span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&lt;== &#23558;&#21464;&#37327;&#21464;&#25104;&#29615;&#22659;&#21464;&#37327;</span>
$ bash  
$ echo $<span style="color: #8787d7;">your_name</span>   <span style="color: #008787; background-color: #262626;"># </span><span style="color: #008787; background-color: #262626;">&lt;== &#36825;&#27425;&#21487;&#20197;&#25104;&#21151;&#36755;&#20986;&#29238;&#31243;&#24207;&#23450;&#20041;&#30340;&#21464;&#37327;</span>
Alice
$ exit
</pre>
</div>

<p>
在目前的 shell 中启用一个新的 shell，新的 shell 就是子进程。<br>
</p>

<p>
在一般的情况下， <span class="underline">子进程仅会继承父进程的环境变量，子进程不会继承父进程的自定义变量</span> ，所以父进程的自定义变量是无法在子进程内使用的，通过 export 将变量变成环境变量后，就能够在子进程下使用。<br>
</p></li>

<li>通常大写字符为系统默认变量，自行设置变量可以使用小写字符，方便判断（纯粹依照使用者兴趣与嗜好）；<br></li>
<li>取消变量的方法为使用 <code>unset</code> ：【unset 变量名称】例如取消 your_name 的设置： <code>unset your_name</code><br></li>
</ul>

<p>
单引号与双引号的最大不同在于双引号仍然可以保有变量的内容，但单引号内仅能是一般字符，而不会有特殊符号。<br>
</p>
</div>
</div>
<div id="outline-container-orga2b45fb" class="outline-3">
<h3 id="orga2b45fb">使用变量</h3>
<div class="outline-text-3" id="text-orga2b45fb">
<p>
使用一个定义过的变量，只要在变量名前面加美元符号即可，如：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8787d7;">your_name</span>=<span style="color: #2aa198;">"haoran"</span>
<span style="color: #268bd2;">echo</span> $<span style="color: #8787d7;">your_name</span>
<span style="color: #268bd2;">echo</span> ${<span style="color: #8787d7;">your_name</span>}
</pre>
</div>

<p>
变量名外面的花括号是可选的，加不加都行，加花括号是为了帮助解释器识别变量的边界，比如下面这种情况：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #268bd2; font-weight: bold;">for</span> skill<span style="color: #268bd2; font-weight: bold;"> in</span> Ada Coffe Action Java; <span style="color: #268bd2; font-weight: bold;">do</span>
  <span style="color: #268bd2;">echo</span> <span style="color: #2aa198;">"I am good at ${skill}Script"</span>
<span style="color: #268bd2; font-weight: bold;">done</span>
</pre>
</div>

<p>
如果不给 <code>skill</code> 变量加花括号，写成 <code>echo "I am good at $skillScript"</code> ，解释器就会把 <code>$skillScript</code> 当成一个变量（其值为空），代码执行结果就不是我们期望的样子了。<br>
</p>

<p>
推荐给所有变量加上花括号，这是个好的编程习惯。IntelliJ IDEA 编写 shell script 时，IDE 就会提示加花括号。<br>
</p>
</div>
</div>
<div id="outline-container-org7e7f2e1" class="outline-3">
<h3 id="org7e7f2e1">重定义变量</h3>
<div class="outline-text-3" id="text-org7e7f2e1">
<p>
已定义的变量，可以被重新定义，如：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8787d7;">your_name</span>=<span style="color: #2aa198;">"Alice"</span>
<span style="color: #268bd2;">echo</span> $<span style="color: #8787d7;">your_name</span>

<span style="color: #8787d7;">your_name</span>=<span style="color: #2aa198;">"Bob"</span>
<span style="color: #268bd2;">echo</span> $<span style="color: #8787d7;">your_name</span>
</pre>
</div>

<p>
这样写是合法的，但注意，第二次赋值的时候不能写 <code>$your_name="alibaba"</code> ，使用变量的时候才加美元符。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-orgbed1f59" class="outline-2">
<h2 id="orgbed1f59">shell 脚本实例</h2>
<div class="outline-text-2" id="text-orgbed1f59">
</div>
<div id="outline-container-orgd17286d" class="outline-3">
<h3 id="orgd17286d">自动 git push</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-06-03 Fri 03:14</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
