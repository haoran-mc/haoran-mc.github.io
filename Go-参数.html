<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-09-28 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>参数</title>
<meta name="author" content="L.M.haoran" />
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved." />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
           <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
           <script type="module" src="static/js/main.js" defer></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">参数</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org95560e5">值传递与引用传递</a></li>
<li><a href="#org71a8589">不定参数传值</a>
<ul>
<li><a href="#org3781913">使用 slice 对象做实参</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org95560e5" class="outline-2">
<h2 id="org95560e5">值传递与引用传递</h2>
<div class="outline-text-2" id="text-org95560e5">
<p>
函数定义时指出，函数定义时有参数，该变量可称为函数的形参。形参就像定义在函数体内的局部变量。<br>
</p>

<p>
但当调用函数，传递过来的变量就是函数的实参，函数可以通过两种方式来传递参数：<br>
</p>

<p>
<b>值传递：</b> 指在调用函数时将实际参数复制一份传递到函数中，这样在函数中如果对参数进行修改，将不会影响到实际参数。<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">swap</span>(<span style="color: #cbccd1;">x</span>, <span style="color: #cbccd1;">y</span> <span style="color: #ee7b29;">int</span>) <span style="color: #ee7b29;">int</span> {
    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">...</span>
}
</pre>
</div>

<p>
<b>引用传递：</b> 是指在调用函数时将实际参数的地址传递到函数中，那么在函数中对参数所进行的修改，将影响到实际参数。<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ea3d54;">package</span> main

<span style="color: #ea3d54;">import</span> (
    <span style="color: #4fb3d8;">"fmt"</span>
)

<span style="color: #5B6268;">/* </span><span style="color: #5B6268;">&#23450;&#20041;&#30456;&#20114;&#20132;&#25442;&#20540;&#30340;&#20989;&#25968; */</span>
<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">swap</span>(<span style="color: #cbccd1;">x</span>, <span style="color: #cbccd1;">y</span> *<span style="color: #ee7b29;">int</span>) {
    <span style="color: #ea3d54;">var</span> <span style="color: #cbccd1;">temp</span> <span style="color: #ee7b29;">int</span>

    temp = *x <span style="color: #5B6268;">/* </span><span style="color: #5B6268;">&#20445;&#23384; x &#30340;&#20540; */</span>
    *x = *y   <span style="color: #5B6268;">/* </span><span style="color: #5B6268;">&#23558; y &#20540;&#36171;&#32473; x */</span>
    *y = temp <span style="color: #5B6268;">/* </span><span style="color: #5B6268;">&#23558; temp &#20540;&#36171;&#32473; y*/</span>

}

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">main</span>() {
    <span style="color: #ea3d54;">var</span> <span style="color: #cbccd1;">a</span>, <span style="color: #cbccd1;">b</span> <span style="color: #ee7b29;">int</span> = 1, 2
    <span style="color: #5B6268;">/*</span>
<span style="color: #5B6268;">                &#35843;&#29992; swap() &#20989;&#25968;</span>
<span style="color: #5B6268;">                &amp;a &#25351;&#21521; a &#25351;&#38024;&#65292;a &#21464;&#37327;&#30340;&#22320;&#22336;</span>
<span style="color: #5B6268;">                &amp;b &#25351;&#21521; b &#25351;&#38024;&#65292;b &#21464;&#37327;&#30340;&#22320;&#22336;</span>
<span style="color: #5B6268;">    */</span>
    <span style="color: #fedd38;">swap</span>(&amp;a, &amp;b)

    fmt.<span style="color: #fedd38;">Println</span>(a, b)
}
</pre>
</div>

<p>
输出结果：<br>
</p>

<pre class="example" id="org46eafdf">
2 1
</pre>

<p>
在默认情况下，Go 语言使用的是值传递，即在调用过程中不会影响到实际参数。<br>
</p>

<p>
<b>注意1：</b> 无论是值传递，还是引用传递，传递给函数的都是变量的副本，不过，值传递是值的拷贝。引用传递是地址的拷贝，一般来说，地址拷贝更为高效。而值拷贝取决于拷贝的对象大小，对象越大，则性能越低。<br>
</p>

<p>
<b>注意2：</b> map、slice、chan、指针、interface 默认以引用的方式传递。<br>
</p>
</div>
</div>
<div id="outline-container-org71a8589" class="outline-2">
<h2 id="org71a8589">不定参数传值</h2>
<div class="outline-text-2" id="text-org71a8589">
<p>
不定参数传值 就是函数的参数不是固定的，后面的类型是固定的。（可变参数）<br>
</p>

<p>
Golang 可变参数本质上就是 slice。只能有一个，且必须是最后一个。<br>
</p>

<p>
在参数赋值时可以不用用一个一个的赋值，可以直接传递一个数组或者切片，特别注意的是在参数后加上“…”即可。<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">myfunc</span>(<span style="color: #cbccd1;">args</span> ...<span style="color: #ee7b29;">int</span>) {    <span style="color: #5B6268;">//</span><span style="color: #5B6268;">0&#20010;&#25110;&#22810;&#20010;&#21442;&#25968;</span>
}

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">add</span>(<span style="color: #cbccd1;">a</span> <span style="color: #ee7b29;">int</span>, <span style="color: #cbccd1;">args</span> ...<span style="color: #ee7b29;">int</span>) <span style="color: #ee7b29;">int</span> {    <span style="color: #5B6268;">//</span><span style="color: #5B6268;">1&#20010;&#25110;&#22810;&#20010;&#21442;&#25968;</span>
}

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">add</span>(<span style="color: #cbccd1;">a</span> <span style="color: #ee7b29;">int</span>, <span style="color: #cbccd1;">b</span> <span style="color: #ee7b29;">int</span>, <span style="color: #cbccd1;">args</span> ...<span style="color: #ee7b29;">int</span>) <span style="color: #ee7b29;">int</span> {    <span style="color: #5B6268;">//</span><span style="color: #5B6268;">2&#20010;&#25110;&#22810;&#20010;&#21442;&#25968;</span>
}
</pre>
</div>

<p>
注意：其中args是一个slice，我们可以通过arg[index]依次访问所有参数，通过len(arg)来判断传递参数的个数.<br>
</p>

<p>
任意类型的不定参数： 就是函数的参数和每个参数的类型都不是固定的。<br>
</p>

<p>
用interface{}传递任意类型数据是Go语言的惯例用法，而且interface{}是类型安全的。<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">myfunc</span>(<span style="color: #cbccd1;">args</span> ...<span style="color: #ea3d54;">interface</span>{}) {
}
</pre>
</div>

<p>
代码：<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ea3d54;">package</span> main

<span style="color: #ea3d54;">import</span> (
    <span style="color: #4fb3d8;">"fmt"</span>
)

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">test</span>(<span style="color: #cbccd1;">s</span> <span style="color: #ee7b29;">string</span>, <span style="color: #cbccd1;">n</span> ...<span style="color: #ee7b29;">int</span>) <span style="color: #ee7b29;">string</span> {
    <span style="color: #ea3d54;">var</span> <span style="color: #cbccd1;">x</span> <span style="color: #ee7b29;">int</span>
    <span style="color: #ea3d54;">for</span> <span style="color: #cbccd1;">_</span>, <span style="color: #cbccd1;">i</span> := <span style="color: #ea3d54;">range</span> n {
        x += i
    }
    <span style="color: #ea3d54;">return</span> fmt.<span style="color: #fedd38;">Sprintf</span>(s, x)
}

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">main</span>() {
    <span style="color: #fedd38;">println</span>(<span style="color: #fedd38;">test</span>(<span style="color: #4fb3d8;">"sum: %d"</span>, 1, 2, 3))
}
</pre>
</div>

<p>
输出结果：<br>
</p>

<pre class="example" id="org90e7389">
sum: 6
</pre>
</div>
<div id="outline-container-org3781913" class="outline-3">
<h3 id="org3781913">使用 slice 对象做实参</h3>
<div class="outline-text-3" id="text-org3781913">
<p>
使用 slice 对象做变参时，必须展开。（slice&#x2026;）<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ea3d54;">package</span> main

<span style="color: #ea3d54;">import</span> (
    <span style="color: #4fb3d8;">"fmt"</span>
)

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">test</span>(<span style="color: #cbccd1;">s</span> <span style="color: #ee7b29;">string</span>, <span style="color: #cbccd1;">n</span> ...<span style="color: #ee7b29;">int</span>) <span style="color: #ee7b29;">string</span> {
    <span style="color: #ea3d54;">var</span> <span style="color: #cbccd1;">x</span> <span style="color: #ee7b29;">int</span>
    <span style="color: #ea3d54;">for</span> <span style="color: #cbccd1;">_</span>, <span style="color: #cbccd1;">i</span> := <span style="color: #ea3d54;">range</span> n {
        x += i
    }
    <span style="color: #ea3d54;">return</span> fmt.<span style="color: #fedd38;">Sprintf</span>(s, x)
}

<span style="color: #ea3d54;">func</span> <span style="color: #fedd38;">main</span>() {
    <span style="color: #cbccd1;">s</span> := []<span style="color: #ee7b29;">int</span>{1, 2, 3}
    <span style="color: #cbccd1;">res</span> := <span style="color: #fedd38;">test</span>(<span style="color: #4fb3d8;">"sum: %d"</span>, s...)    <span style="color: #5B6268;">// </span><span style="color: #5B6268;">slice... &#23637;&#24320;slice</span>
    <span style="color: #fedd38;">println</span>(res)
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-02-09 23:02 Wed</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-09-28</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
