<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-02-01 Tue 17:57 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GO-REGEXP包</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">GO-REGEXP包</h1>
<p>
正则表达式语法和使用的详细信息请参考 <a href="Regular-expression.html">Regular-expression</a> 。<br>
</p>

<p>
在下面的程序里，我们将在字符串中对正则表达式进行匹配。<br>
</p>

<p>
如果是简单模式，使用 Match 方法便可：<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #8787d7;">ok</span>, <span style="color: #8787d7;">_</span> := regexp.<span style="color: #d75fd7; font-weight: bold;">Match</span>(pat, []<span style="color: #d75fd7; font-weight: bold;">byte</span>(searchIn))
</pre>
</div>

<p>
变量 ok 将返回 true 或者 false, 我们也可以使用 MatchString：<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #8787d7;">ok</span>, <span style="color: #8787d7;">_</span> := regexp.<span style="color: #d75fd7; font-weight: bold;">MatchString</span>(pat, searchIn)
</pre>
</div>

<p>
更多方法中，必须先将正则通过 Compile 方法返回一个 Regexp 对象。然后我们将掌握一些匹配，查找，替换相关的功能。<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main
<span style="color: #268bd2; font-weight: bold;">import</span> (
        <span style="color: #2aa198;">"fmt"</span>
        <span style="color: #2aa198;">"regexp"</span>
        <span style="color: #2aa198;">"strconv"</span>
)
<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
        <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#30446;&#26631;&#23383;&#31526;&#20018;</span>
        <span style="color: #8787d7;">searchIn</span> := <span style="color: #2aa198;">"John: 2578.34 William: 4567.23 Steve: 5632.18"</span>
        <span style="color: #8787d7;">pat</span> := <span style="color: #2aa198;">"[0-9]+.[0-9]+"</span> <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#27491;&#21017;</span>

        <span style="color: #8787d7;">f</span> := <span style="color: #268bd2; font-weight: bold;">func</span>(<span style="color: #8787d7;">s</span> <span style="color: #df005f; font-weight: bold;">string</span>) <span style="color: #df005f; font-weight: bold;">string</span>{
                <span style="color: #8787d7;">v</span>, <span style="color: #8787d7;">_</span> := strconv.<span style="color: #d75fd7; font-weight: bold;">ParseFloat</span>(s, <span style="color: #d75fd7;">32</span>)
                <span style="color: #268bd2; font-weight: bold;">return</span> strconv.<span style="color: #d75fd7; font-weight: bold;">FormatFloat</span>(v * <span style="color: #d75fd7;">2</span>, <span style="color: #2aa198;">'f'</span>, <span style="color: #d75fd7;">2</span>, <span style="color: #d75fd7;">32</span>)
        }

        <span style="color: #268bd2; font-weight: bold;">if</span> <span style="color: #8787d7;">ok</span>, <span style="color: #8787d7;">_</span> := regexp.<span style="color: #d75fd7; font-weight: bold;">Match</span>(pat, []<span style="color: #d75fd7; font-weight: bold;">byte</span>(searchIn)); ok {
                fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"Match Found!"</span>)
        }

        <span style="color: #8787d7;">re</span>, <span style="color: #8787d7;">_</span> := regexp.<span style="color: #d75fd7; font-weight: bold;">Compile</span>(pat)
        <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#23558;&#21305;&#37197;&#21040;&#30340;&#37096;&#20998;&#26367;&#25442;&#20026;"##.#"</span>
        <span style="color: #8787d7;">str</span> := re.<span style="color: #d75fd7; font-weight: bold;">ReplaceAllString</span>(searchIn, <span style="color: #2aa198;">"##.#"</span>)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(str)
        <span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#21442;&#25968;&#20026;&#20989;&#25968;&#26102;</span>
        <span style="color: #8787d7;">str2</span> := re.<span style="color: #d75fd7; font-weight: bold;">ReplaceAllStringFunc</span>(searchIn, f)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(str2)
}
</pre>
</div>

<p>
输出结果：<br>
</p>

<pre class="example" id="orga21419b">
Match Found!
John: ##.# William: ##.# Steve: ##.#
John: 5156.68 William: 9134.46 Steve: 11264.36
</pre>

<p>
Compile 函数也可能返回一个错误，我们在使用时忽略对错误的判断是因为我们确信自己正则表达式是有效的。当用户输入或从数据中获取正则表达式的时候，我们有必要去检验它的正确性。另外我们也可以使用 MustCompile 方法，它可以像 Compile 方法一样检验正则的有效性，但是当正则不合法时程序将 panic。<br>
</p>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-02-01 17:02 Tue</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-02-01 Tue 17:57</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
