<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-01-22 Sat 16:16 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VIMSCRIPT-路径</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">VIMSCRIPT-路径</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgee8f55d">路径</a></li>
<li><a href="#org07c23aa">绝对路径</a></li>
<li><a href="#org838b953">列出文件</a></li>
<li><a href="#org66dccf4">fnamemodify</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgee8f55d" class="outline-2">
<h2 id="orgee8f55d">路径</h2>
<div class="outline-text-2" id="text-orgee8f55d">
<p>
Vim 是一个文本编辑器，并且文本编辑器经常是对文本文件进行操作。<br>
文本文件是在文件系统里进行管理的，我们需要通过文件路径来指定文件。<br>
当你需要对路径进行操作的时候，vim 提供了一些很有用的内置函数。<br>
</p>
</div>
</div>

<div id="outline-container-org07c23aa" class="outline-2">
<h2 id="org07c23aa">绝对路径</h2>
<div class="outline-text-2" id="text-org07c23aa">
<p>
有些时候外部脚本取得某些文件的路径是很简单的。运行下面的命令：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">:echom expand(<span style="color: #FC9F4E;">'%'</span>)
:echom expand(<span style="color: #FC9F4E;">'%:p'</span>)
:echom fnamemodify(<span style="color: #FC9F4E;">'foo.txt'</span>,<span style="color: #FC9F4E;">':p'</span>)
</pre>
</div>

<p>
第一条命令用来显示你当前在编辑的文件的相对路径。% 代表 “当前文件”。vim 里还有很多可以用 expand() 来进行替换的字符串。<br>
</p>

<p>
第二条命令会输出当前文件的全路径。字符串里的:p 用来告诉 vim 取文件的全路径。vim 里也有很多这样的修饰符可以使用。<br>
</p>

<p>
第三条命令根据当前路径显示 foo.txt 文件的绝对路径，而不用考虑这个文件是否存在。<br>
fnamemodify() 是一个 vim 函数，它比 expand() 函数更加灵活，因为它可以指定任何文件，不仅仅只是 expand() 的特殊字符。<br>
</p>
</div>
</div>

<div id="outline-container-org838b953" class="outline-2">
<h2 id="org838b953">列出文件</h2>
<div class="outline-text-2" id="text-org838b953">
<p>
有时候你会需要取得某个目录下的文件列表。运行下面的命令：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">:echo globpath(<span style="color: #FC9F4E;">'.'</span>,<span style="color: #FC9F4E;">'*'</span>)
</pre>
</div>

<p>
Vim 会列出当前目录下的所有文件。globpath() 函数返回一个字符串，包含所有的文件名，文件名之间用回车分割。如果想要拿到第一个列表的话，你可以自己用 split 来切分。运行下面的命令：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">:echo split(globpath(<span style="color: #FC9F4E;">'.'</span>,<span style="color: #FC9F4E;">'*'</span>),<span style="color: #FC9F4E;">'n'</span>)
</pre>
</div>

<p>
这次 vim 会输出一个包含所有文件的列表。<br>
</p>

<p>
golbpath 函数的通配符基本上也是按照你所认为的方式去工作的。运行下面的命令：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">:echo split(globpath(<span style="color: #FC9F4E;">'.'</span>,<span style="color: #FC9F4E;">'*.txt'</span>),<span style="color: #FC9F4E;">'n'</span>)
</pre>
</div>

<p>
Vim 输出当前目录的下所有的以.txt 结尾的文件的列表。<br>
</p>

<p>
你可以通过**来递归地列举当前文件夹下的所有文件。运行下面的命令：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">:echo split(globpath(<span style="color: #FC9F4E;">'.'</span>,<span style="color: #FC9F4E;">'**'</span>))
</pre>
</div>

<p>
Vim 会输出当前文件夹下的所有文件和文件夹。<br>
</p>

<p>
globpath 的功能非常强大，在你完成本章的练习之后，你会学到更多东西。<br>
</p>
</div>
</div>

<div id="outline-container-org66dccf4" class="outline-2">
<h2 id="org66dccf4">fnamemodify</h2>
<div class="outline-text-2" id="text-org66dccf4">
<div class="org-src-container">
<pre class="src src-shell">:help filename-modifiers
</pre>
</div>

<p>
可用选项如下：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">:echo fnamemodify(<span style="color: #FC9F4E;">"main.c"</span>, <span style="color: #FC9F4E;">":p:h"</span>)

:_%: ::8 ::p ::. ::~ ::h ::t ::r ::e ::s ::gs ::S 
%:8 %:p %:. %:~ %:h %:t %:r %:e %:s %:gs %:S
</pre>
</div>
<p>
各种效果如下：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell">Examples, when the file name is <span style="color: #FC9F4E;">"src/version.c"</span>, current dir
<span style="color: #FC9F4E;">"/home/mool/vim"</span>: &gt;
:p            /home/mool/vim/src/version.c
:p:.                       src/version.c
:p:~                 ~/vim/src/version.c
:h                       src
:p:h            /home/mool/vim/src
:p:h:h        /home/mool/vim
:t                       version.c
:p:t                       version.c
:r                       src/version
:p:r            /home/mool/vim/src/version
:t:r                       version
:e                           c
:s?version?main?               src/main.c
:s?version?main?:p    /home/mool/vim/src/main.c
:p:gs?/?<span style="color: #FC9F4E;">\\</span>?        homemoolvimsrcversion.c

Examples, when the file name is <span style="color: #FC9F4E;">"src/version.c.gz"</span>: &gt;
:p            /home/mool/vim/src/version.c.gz
:e                             gz
:e:e                           c.gz
:e:e:e                       c.gz
:e:e:r                       c
:r                       src/version.c
:r:e                           c
:r:r                       src/version
:r:r:r                   src/version
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-01-22 16:01 Sat</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-01-22 Sat 16:16</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
