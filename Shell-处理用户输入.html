<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2023-01-25 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>处理用户输入</title>
<meta name="author" content="Haoran Liu" />
<meta name="description" content="Copyright © 2023, Haoran Liu, all rights reserved." />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="static/css/org.css"/>
</head>
<body>
<div id="content" class="content">
<h1 class="title">处理用户输入</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc6e3cdf">脚本文件携带参数</a></li>
<li><a href="#org6f39830">处理选项</a></li>
<li><a href="#orgdfc2c1e">读取来自键盘输入的变量</a>
<ul>
<li><a href="#orgee0493a">从文件中读取</a></li>
</ul>
</li>
<li><a href="#orgfaf8c08">输入数字数组</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgc6e3cdf" class="outline-2">
<h2 id="orgc6e3cdf">脚本文件携带参数</h2>
<div class="outline-text-2" id="text-orgc6e3cdf">
<p>
<a href="Shell-变量.html#org87f4468">shell脚本的默认变量（$0、$1&#x2026;）</a><br>
</p>

<p>
使用默认变量的时候，记得提前检查 <code>[ -n "$1" ]</code> 其中是否有数据。<br>
</p>
</div>
</div>
<div id="outline-container-org6f39830" class="outline-2">
<h2 id="org6f39830">处理选项</h2>
<div class="outline-text-2" id="text-org6f39830">
<p>
<code>getopt</code> 、 <code>getopts</code><br>
</p>
</div>
</div>
<div id="outline-container-orgdfc2c1e" class="outline-2">
<h2 id="orgdfc2c1e">读取来自键盘输入的变量</h2>
<div class="outline-text-2" id="text-orgdfc2c1e">
<p>
<a href="Linux-bash.html#orge9cb088">键盘读取变量：read</a><br>
</p>

<pre class="example" id="orgc8c1979">
read - read from a file descriptor

- -p :: 提示信息；
- -a :: 将输入的数据进行空格分隔成数组；
- -d :: 设置结束符；
- -t :: 时间限制，规定时间内没有输入变量就会结束该命令；
- -n :: 设置输入的长度；
- -s :: 不显示输入的数据，输入密码时可以使用；
</pre>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #1ea8fc;">read</span> -p <span style="color: #7984D1;">"&#35831;&#36755;&#20837;&#20320;&#30340;&#21517;&#23383;&#65306;"</span> your_name
<span style="color: #1ea8fc;">echo</span> $<span style="color: #df85ff;">your_name</span>
</pre>
</div>
</div>
<div id="outline-container-orgee0493a" class="outline-3">
<h3 id="orgee0493a">从文件中读取</h3>
<div class="outline-text-3" id="text-orgee0493a">
<div class="org-src-container">
<pre class="src src-shell">  <span style="color: #546A90;">#</span><span style="color: #546A90;">!/bin/bash</span>
<span style="color: #df85ff;">count</span>=1
cat test.txt | <span style="color: #ff2afc; font-weight: bold;">while </span><span style="color: #1ea8fc;">read</span> line
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"Line $count: $line"</span>
  <span style="color: #df85ff;">count</span>=$[ $<span style="color: #df85ff;">count</span> + 1 ]
<span style="color: #ff2afc; font-weight: bold;">done</span>
<span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"Finished processing the file"</span>
</pre>
</div>

<p>
<code>while</code> 循环会持续通过 <code>read</code> 命令处理文件中的行，直到 <code>read</code> 命令以非零状态码退出。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-orgfaf8c08" class="outline-2">
<h2 id="orgfaf8c08">输入数字数组</h2>
<div class="outline-text-2" id="text-orgfaf8c08">
<p>
假定让你输入多个数，以回车结束输入，然后计算输入数的平均值，怎么办？<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #546A90;">#</span><span style="color: #546A90;">!/bin/</span><span style="color: #ff2afc; font-weight: bold;">bash</span>
<span style="color: #1ea8fc;">declare</span> -ai num

<span style="color: #1ea8fc;">read</span> -p <span style="color: #7984D1;">"Please input some numbers: "</span> -a num

<span style="color: #1ea8fc;">declare</span> -i <span style="color: #df85ff;">len</span>=${#<span style="color: #df85ff;">num</span>[*]}
<span style="color: #1ea8fc;">declare</span> -i <span style="color: #df85ff;">sum</span>=0

<span style="color: #ff2afc; font-weight: bold;">for</span> (( <span style="color: #df85ff;">i</span>=1; i&lt;$<span style="color: #df85ff;">len</span>; i++ ))
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">let</span> <span style="color: #df85ff;">sum</span>=sum+num[i]
<span style="color: #ff2afc; font-weight: bold;">done</span>

<span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"$sum, $len"</span>
<span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"scale=2; $sum/$len"</span> | bc
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-01-21 16:01 Sat</p>
<p class="author">Author: Haoran Liu</p>
<p class="date">Created: 2023-01-25</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
