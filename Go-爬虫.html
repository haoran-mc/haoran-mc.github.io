<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2023-02-03 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Go爬虫</title>
<meta name="author" content="Haoran Liu" />
<meta name="description" content="Copyright © 2023, Haoran Liu, all rights reserved." />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
           <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
           <script type="module" src="static/js/main.js" defer></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Go爬虫</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgf173782">一个简单的爬虫例子</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgf173782" class="outline-2">
<h2 id="orgf173782">一个简单的爬虫例子</h2>
<div class="outline-text-2" id="text-orgf173782">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #fb4934;">package</span> main

<span style="color: #fb4934;">import</span> (
    <span style="color: #b8bb26;">"fmt"</span>
    <span style="color: #b8bb26;">"io"</span>
    <span style="color: #b8bb26;">"net/http"</span>
    <span style="color: #b8bb26;">"regexp"</span>
)

<span style="color: #928374; font-style: italic;">// </span><span style="color: #928374; font-style: italic;">&#36825;&#20010;&#21482;&#26159;&#19968;&#20010;&#31616;&#21333;&#30340;&#29256;&#26412;&#21482;&#26159;&#33719;&#21462;QQ&#37038;&#31665;&#24182;&#19988;&#27809;&#26377;&#36827;&#34892;&#23553;&#35013;&#25805;&#20316;&#65292;&#21478;&#22806;&#29228;&#20986;&#26469;&#30340;&#25968;&#25454;&#20063;&#27809;&#26377;&#36827;&#34892;&#21435;&#37325;&#25805;&#20316;</span>
<span style="color: #fb4934;">var</span> (
    <span style="color: #83a598;">reQQEmail</span> = <span style="color: #b8bb26;">`(\d+)@qq.com`</span>
)

<span style="color: #fb4934;">func</span> <span style="color: #b8bb26;">GetEmail</span>() {
    <span style="color: #928374; font-style: italic;">// </span><span style="color: #928374; font-style: italic;">1. &#21435;&#32593;&#31449;&#25343;&#25968;&#25454;</span>
    <span style="color: #83a598;">resp</span>, <span style="color: #83a598;">err</span> := http.<span style="color: #b8bb26;">Get</span>(<span style="color: #b8bb26;">"https://tieba.baidu.com/p/6051076813?red_tag=1573533731"</span>)
    <span style="color: #fb4934;">if</span> err != <span style="color: #d3869b;">nil</span> {
        fmt.<span style="color: #b8bb26;">Println</span>(<span style="color: #b8bb26;">"http.Get"</span>, err.<span style="color: #b8bb26;">Error</span>())
    }
    <span style="color: #fb4934;">defer</span> resp.Body.<span style="color: #b8bb26;">Close</span>()

    <span style="color: #928374; font-style: italic;">// </span><span style="color: #928374; font-style: italic;">2. &#35835;&#21462;&#39029;&#38754;&#20869;&#23481;</span>
    <span style="color: #83a598;">pageBytes</span>, <span style="color: #83a598;">err</span> := io.<span style="color: #b8bb26;">ReadAll</span>(resp.Body)
    <span style="color: #fb4934;">if</span> err != <span style="color: #d3869b;">nil</span> {
        fmt.<span style="color: #b8bb26;">Println</span>(<span style="color: #b8bb26;">"io.ReadAll"</span>, err.<span style="color: #b8bb26;">Error</span>())
    }
    <span style="color: #83a598;">pageStr</span> := <span style="color: #b8bb26;">string</span>(pageBytes)

    <span style="color: #928374; font-style: italic;">// </span><span style="color: #928374; font-style: italic;">3. &#36807;&#28388;&#25968;&#25454;&#65292;&#36807;&#28388;qq&#37038;&#31665;</span>
    <span style="color: #83a598;">re</span> := regexp.<span style="color: #b8bb26;">MustCompile</span>(reQQEmail)
    <span style="color: #83a598;">results</span> := re.<span style="color: #b8bb26;">FindAllStringSubmatch</span>(pageStr, -1)

    <span style="color: #fb4934;">for</span> <span style="color: #83a598;">_</span>, <span style="color: #83a598;">result</span> := <span style="color: #fb4934;">range</span> results {
        fmt.<span style="color: #b8bb26;">Println</span>(<span style="color: #b8bb26;">"email:"</span>, result[0])
        fmt.<span style="color: #b8bb26;">Println</span>(<span style="color: #b8bb26;">"qq:"</span>, result[1])
    }
}

<span style="color: #fb4934;">func</span> <span style="color: #b8bb26;">main</span>() {
    <span style="color: #b8bb26;">GetEmail</span>()
}
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-02-02 11:02 Thu</p>
<p class="author">Author: Haoran Liu</p>
<p class="date">Created: 2023-02-03</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
