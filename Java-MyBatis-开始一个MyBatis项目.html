<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2021-12-09 Thu 15:08 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>开始一个MYBATIS项目</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2021, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">开始一个MYBATIS项目</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org06045dc">1. 本地创建数据库</a></li>
<li><a href="#orgccf2403">2. 新建一个 Maven 项目</a></li>
<li><a href="#org8cc4016">3. 添加依赖</a></li>
<li><a href="#orgc45170d">4. 添加 mybatis 配置文件</a></li>
<li><a href="#org7885331">5. 编写工具类连接接数据库</a></li>
<li><a href="#org9339da5">6. 写实体类 User</a></li>
<li><a href="#orga188fa1">7. 写接口 UserMapper</a></li>
<li><a href="#org8dbc215">8. 实现接口，编写 UserMapper.mxl</a></li>
<li><a href="#org920e70d">9. 注册 UserMapper.xml</a></li>
<li><a href="#org86e4331">10. 然后编写测试代码，查看是否成功</a></li>
</ul>
</div>
</div>

<div id="outline-container-org06045dc" class="outline-2">
<h2 id="org06045dc">1. 本地创建数据库</h2>
<div class="outline-text-2" id="text-org06045dc">
<p>
本地创建一个名为 mybatis 的数据库，并添加一些表，这里只添加了一个用户表。<br>
</p>

<div class="org-src-container">
<pre class="src src-sql"><span style="color: #BD93F9;">create</span> database mybatis;

use mybatis;

<span style="color: #BD93F9;">create</span> <span style="color: #BD93F9;">table</span> mybatis.<span style="color: #AFAFAF;">user</span> (
id   <span style="color: #AFAFAF;">int</span> auto_increment <span style="color: #BD93F9;">primary</span> <span style="color: #BD93F9;">key</span>,
username <span style="color: #AFAFAF;">varchar</span>(<span style="color: #009F9F;">30</span>) <span style="color: #BD93F9;">not</span> <span style="color: #BD93F9;">null</span>,
password  <span style="color: #AFAFAF;">varchar</span>(<span style="color: #009F9F;">30</span>) <span style="color: #BD93F9;">not</span> <span style="color: #BD93F9;">null</span>,
<span style="color: #BD93F9;">constraint</span> user_id_uindex
<span style="color: #BD93F9;">unique</span> (id)
);
</pre>
</div>

<p>
插入一些测试数据：<br>
</p>
<div class="org-src-container">
<pre class="src src-sql"><span style="color: #BD93F9;">insert</span> <span style="color: #BD93F9;">into</span> mybatis.<span style="color: #AFAFAF;">user</span> <span style="color: #BD93F9;">values</span>
(<span style="color: #009F9F;">1</span>, <span style="color: #FC9F4E;">'user01'</span>, <span style="color: #FC9F4E;">'123456'</span>),
(<span style="color: #009F9F;">2</span>, <span style="color: #FC9F4E;">'user02'</span>, <span style="color: #FC9F4E;">'123456'</span>),
(<span style="color: #009F9F;">3</span>, <span style="color: #FC9F4E;">'user03'</span>, <span style="color: #FC9F4E;">'123456'</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgccf2403" class="outline-2">
<h2 id="orgccf2403">2. 新建一个 Maven 项目</h2>
<div class="outline-text-2" id="text-orgccf2403">
<p>
我们的数据库里有 user 这个表，我们创建一个 maven 的项目，使用 mybatis 查询数据库中的 user 这个表。<br>
</p>

<p>
创建 Maven 项目的过程就省略了，简单的创建就可以。<br>
</p>
</div>
</div>
<div id="outline-container-org8cc4016" class="outline-2">
<h2 id="org8cc4016">3. 添加依赖</h2>
<div class="outline-text-2" id="text-org8cc4016">
<p>
在 pom.xml 中添加三个依赖：<br>
</p>
<ol class="org-ol">
<li>mysql<br></li>
<li>mybatis<br></li>
<li>junit，用来测试的<br></li>
</ol>

<div class="org-src-container">
<pre class="src src-xml"><span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#28155;&#21152;&#20381;&#36182;</span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
&lt;<span style="color: #AFAFAF;">dependencies</span>&gt;
  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">mysql&#39537;&#21160; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">dependency</span>&gt;
    &lt;<span style="color: #AFAFAF;">groupId</span>&gt;mysql&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
    &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;mysql-connector-java&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
    &lt;<span style="color: #AFAFAF;">version</span>&gt;8.0.24&lt;/<span style="color: #AFAFAF;">version</span>&gt;
  &lt;/<span style="color: #AFAFAF;">dependency</span>&gt;
  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">mybatis </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">dependency</span>&gt;
    &lt;<span style="color: #AFAFAF;">groupId</span>&gt;org.mybatis&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
    &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;mybatis&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
    &lt;<span style="color: #AFAFAF;">version</span>&gt;3.5.2&lt;/<span style="color: #AFAFAF;">version</span>&gt;
  &lt;/<span style="color: #AFAFAF;">dependency</span>&gt;
  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">junit </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">dependency</span>&gt;
    &lt;<span style="color: #AFAFAF;">groupId</span>&gt;junit&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
    &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;junit&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
    &lt;<span style="color: #AFAFAF;">version</span>&gt;4.12&lt;/<span style="color: #AFAFAF;">version</span>&gt;
    &lt;<span style="color: #AFAFAF;">scope</span>&gt;test&lt;/<span style="color: #AFAFAF;">scope</span>&gt;
  &lt;/<span style="color: #AFAFAF;">dependency</span>&gt;
&lt;/<span style="color: #AFAFAF;">dependencies</span>&gt;
</pre>
</div>

<p>
还要配置 resources，防止资源导出失败，最终的 pom.xml 文件内容：<br>
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #BD93F9;">xml</span> <span style="color: #009F9F; font-style: italic;">version="1.0" encoding="UTF-8"</span>?&gt;
&lt;<span style="color: #AFAFAF;">project</span> <span style="color: #AFAFAF;">xmlns</span>=<span style="color: #FC9F4E;">"http://maven.apache.org/POM/4.0.0"</span>
         <span style="color: #AFAFAF;">xmlns</span>:<span style="color: #AFAFAF;">xsi</span>=<span style="color: #FC9F4E;">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span style="color: #AFAFAF;">xsi</span>:<span style="color: #AFAFAF;">schemaLocation</span>=<span style="color: #FC9F4E;">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;
  &lt;<span style="color: #AFAFAF;">modelVersion</span>&gt;4.0.0&lt;/<span style="color: #AFAFAF;">modelVersion</span>&gt;

  &lt;<span style="color: #AFAFAF;">groupId</span>&gt;org.example&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
  &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;02-secondMybatis&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
  &lt;<span style="color: #AFAFAF;">version</span>&gt;1.0-SNAPSHOT&lt;/<span style="color: #AFAFAF;">version</span>&gt;

  &lt;<span style="color: #AFAFAF;">properties</span>&gt;
    &lt;<span style="color: #AFAFAF;">maven.compiler.source</span>&gt;8&lt;/<span style="color: #AFAFAF;">maven.compiler.source</span>&gt;
    &lt;<span style="color: #AFAFAF;">maven.compiler.target</span>&gt;8&lt;/<span style="color: #AFAFAF;">maven.compiler.target</span>&gt;
  &lt;/<span style="color: #AFAFAF;">properties</span>&gt;

  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#28155;&#21152;&#20381;&#36182;</span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">dependencies</span>&gt;
    <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">mysql&#39537;&#21160; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
    &lt;<span style="color: #AFAFAF;">dependency</span>&gt;
      &lt;<span style="color: #AFAFAF;">groupId</span>&gt;mysql&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
      &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;mysql-connector-java&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
      &lt;<span style="color: #AFAFAF;">version</span>&gt;8.0.24&lt;/<span style="color: #AFAFAF;">version</span>&gt;
    &lt;/<span style="color: #AFAFAF;">dependency</span>&gt;
    <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">mybatis </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
    &lt;<span style="color: #AFAFAF;">dependency</span>&gt;
      &lt;<span style="color: #AFAFAF;">groupId</span>&gt;org.mybatis&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
      &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;mybatis&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
      &lt;<span style="color: #AFAFAF;">version</span>&gt;3.5.2&lt;/<span style="color: #AFAFAF;">version</span>&gt;
    &lt;/<span style="color: #AFAFAF;">dependency</span>&gt;
    <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">junit </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
    &lt;<span style="color: #AFAFAF;">dependency</span>&gt;
      &lt;<span style="color: #AFAFAF;">groupId</span>&gt;junit&lt;/<span style="color: #AFAFAF;">groupId</span>&gt;
      &lt;<span style="color: #AFAFAF;">artifactId</span>&gt;junit&lt;/<span style="color: #AFAFAF;">artifactId</span>&gt;
      &lt;<span style="color: #AFAFAF;">version</span>&gt;4.12&lt;/<span style="color: #AFAFAF;">version</span>&gt;
      &lt;<span style="color: #AFAFAF;">scope</span>&gt;test&lt;/<span style="color: #AFAFAF;">scope</span>&gt;
    &lt;/<span style="color: #AFAFAF;">dependency</span>&gt;
  &lt;/<span style="color: #AFAFAF;">dependencies</span>&gt;


  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#22312; build &#20013;&#37197;&#32622; resources&#65292;&#26469;&#38450;&#27490;&#36164;&#28304;&#23548;&#20986;&#22833;&#36133;&#38382;&#39064; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">build</span>&gt;
    &lt;<span style="color: #AFAFAF;">resources</span>&gt;
      &lt;<span style="color: #AFAFAF;">resource</span>&gt;
        &lt;<span style="color: #AFAFAF;">directory</span>&gt;src/main/resources&lt;/<span style="color: #AFAFAF;">directory</span>&gt;
        &lt;<span style="color: #AFAFAF;">includes</span>&gt;
          &lt;<span style="color: #AFAFAF;">include</span>&gt;**/*.properties&lt;/<span style="color: #AFAFAF;">include</span>&gt;
          &lt;<span style="color: #AFAFAF;">include</span>&gt;**/*.xml&lt;/<span style="color: #AFAFAF;">include</span>&gt;
        &lt;/<span style="color: #AFAFAF;">includes</span>&gt;
        &lt;<span style="color: #AFAFAF;">filtering</span>&gt;true&lt;/<span style="color: #AFAFAF;">filtering</span>&gt;
      &lt;/<span style="color: #AFAFAF;">resource</span>&gt;
      &lt;<span style="color: #AFAFAF;">resource</span>&gt;
        &lt;<span style="color: #AFAFAF;">directory</span>&gt;src/main/java&lt;/<span style="color: #AFAFAF;">directory</span>&gt;
        &lt;<span style="color: #AFAFAF;">includes</span>&gt;
          &lt;<span style="color: #AFAFAF;">include</span>&gt;**/*.properties&lt;/<span style="color: #AFAFAF;">include</span>&gt;
          &lt;<span style="color: #AFAFAF;">include</span>&gt;**/*.xml&lt;/<span style="color: #AFAFAF;">include</span>&gt;
        &lt;/<span style="color: #AFAFAF;">includes</span>&gt;
        &lt;<span style="color: #AFAFAF;">filtering</span>&gt;true&lt;/<span style="color: #AFAFAF;">filtering</span>&gt;
      &lt;/<span style="color: #AFAFAF;">resource</span>&gt;
    &lt;/<span style="color: #AFAFAF;">resources</span>&gt;
  &lt;/<span style="color: #AFAFAF;">build</span>&gt;
&lt;/<span style="color: #AFAFAF;">project</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc45170d" class="outline-2">
<h2 id="orgc45170d">4. 添加 mybatis 配置文件</h2>
<div class="outline-text-2" id="text-orgc45170d">
<p>
在 /src/main/resource 目录下添加 mybatis 配置文件，文件名一般使用 mybatis-config.xml。<br>
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #BD93F9;">xml</span> <span style="color: #009F9F; font-style: italic;">version="1.0" encoding="UTF-8" </span>?&gt;
&lt;!DOCTYPE configuration
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;

<span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#21644;&#34892;&#37197;&#32622;&#25991;&#20214; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
&lt;<span style="color: #AFAFAF;">configuration</span>&gt;
  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#21487;&#20197;&#37197;&#32622;&#22810;&#20010;&#29615;&#22659;&#65292;&#40664;&#35748;&#30340;&#29615;&#22659;&#26159; development </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">environments</span> <span style="color: #AFAFAF;">default</span>=<span style="color: #FC9F4E;">"development"</span>&gt;
    &lt;<span style="color: #AFAFAF;">environment</span> <span style="color: #AFAFAF;">id</span>=<span style="color: #FC9F4E;">"development"</span>&gt;
      &lt;<span style="color: #AFAFAF;">transactionManager</span> <span style="color: #AFAFAF;">type</span>=<span style="color: #FC9F4E;">"JDBC"</span>/&gt;
      &lt;<span style="color: #AFAFAF;">dataSource</span> <span style="color: #AFAFAF;">type</span>=<span style="color: #FC9F4E;">"POOLED"</span>&gt;
        <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#39537;&#21160; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"driver"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"com.mysql.cj.jdbc.Driver"</span>/&gt;
        <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#25968;&#25454;&#24211; url &#36335;&#24452; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"url"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"jdbc:mysql://localhost:3306/mybatis?useSSL=true</span><span style="color: #009F9F;">&amp;</span><span style="color: #009F9F;">amp</span><span style="color: #009F9F;">;</span><span style="color: #FC9F4E;">useUnicode=true</span><span style="color: #009F9F;">&amp;</span><span style="color: #009F9F;">amp</span><span style="color: #009F9F;">;</span><span style="color: #FC9F4E;">characterEncoding=UTF-8"</span>/&gt;
        &lt;1-- &#25968;&#25454;&#24211;&#29992;&#25143;&#21517; --&gt;
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"username"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"root"</span>/&gt;
        <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#25968;&#25454;&#24211;&#23494;&#30721; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"password"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"haoran232"</span>/&gt;
      &lt;/<span style="color: #AFAFAF;">dataSource</span>&gt;
    &lt;/<span style="color: #AFAFAF;">environment</span>&gt;
  &lt;/<span style="color: #AFAFAF;">environments</span>&gt;
&lt;/<span style="color: #AFAFAF;">configuration</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org7885331" class="outline-2">
<h2 id="org7885331">5. 编写工具类连接接数据库</h2>
<div class="outline-text-2" id="text-org7885331">
<img src="./images/Mybatis01.png" width=400px />

<div class="org-src-container">
<pre class="src src-java"><span style="color: #BD93F9;">package</span> com.meta.<span style="color: #009F9F;">utils</span>;

<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">org</span>.<span style="color: #009F9F;">apache</span>.<span style="color: #009F9F;">ibatis</span>.<span style="color: #009F9F;">io</span>.<span style="color: #AFAFAF;">Resources</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">org</span>.<span style="color: #009F9F;">apache</span>.<span style="color: #009F9F;">ibatis</span>.<span style="color: #009F9F;">session</span>.<span style="color: #AFAFAF;">SqlSession</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">org</span>.<span style="color: #009F9F;">apache</span>.<span style="color: #009F9F;">ibatis</span>.<span style="color: #009F9F;">session</span>.<span style="color: #AFAFAF;">SqlSessionFactory</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">org</span>.<span style="color: #009F9F;">apache</span>.<span style="color: #009F9F;">ibatis</span>.<span style="color: #009F9F;">session</span>.<span style="color: #AFAFAF;">SqlSessionFactoryBuilder</span>;

<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">java</span>.<span style="color: #009F9F;">io</span>.<span style="color: #AFAFAF;">IOException</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">java</span>.<span style="color: #009F9F;">io</span>.<span style="color: #AFAFAF;">InputStream</span>;

<span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">sqlSessionFactory  --&gt;  sqlSession</span>
<span style="color: #BD93F9;">public</span> <span style="color: #BD93F9;">class</span> <span style="color: #AFAFAF;">MybatisUtils</span> {
    <span style="color: #BD93F9;">private</span> <span style="color: #BD93F9;">static</span> <span style="color: #AFAFAF;">SqlSessionFactory</span> <span style="color: #AFAFAF;">sqlSessionFactory</span>;

    <span style="color: #BD93F9;">static</span> {
        <span style="color: #BD93F9;">try</span> {
            <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">1. &#31532;&#19968;&#27493;&#65292;&#23547;&#25214;&#36164;&#28304;&#65292;&#25105;&#20204;&#30340;&#36164;&#28304;&#36335;&#24452;&#24050;&#32463;&#22312; mybatis &#37197;&#32622;&#25991;&#20214;&#20013;&#35774;&#32622;&#22909;&#20102;</span>
            <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">resource</span> = <span style="color: #FC9F4E;">"mybatis-config.xml"</span>;
            <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">2. &#25226;&#36164;&#28304;&#35835;&#21462;&#21040;&#27969;&#20013;</span>
            <span style="color: #AFAFAF;">InputStream</span> <span style="color: #AFAFAF;">inputStream</span> = Resources.getResourceAsStream(resource);
            <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">3. &#26500;&#24314; sqlSessionFactory</span>
            <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">SqlSessionFactory &#19968;&#26086;&#34987;&#21019;&#24314;&#23601;&#24212;&#35813;&#22312;&#24212;&#29992;&#30340;&#36816;&#34892;&#26399;&#38388;&#19968;&#30452;&#23384;&#22312;&#65292;&#27809;&#26377;&#20219;&#20309;&#29702;&#30001;&#20002;&#24323;&#23427;&#25110;&#37325;&#26032;&#21019;&#24314;&#21478;&#19968;&#20010;&#23454;&#20363;&#12290;</span>
            <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">&#20351;&#29992; SqlSessionFactory &#30340;&#26368;&#20339;&#23454;&#36341;&#26159;&#22312;&#24212;&#29992;&#36816;&#34892;&#26399;&#38388;&#19981;&#35201;&#37325;&#22797;&#21019;&#24314;&#22810;&#27425;&#65292;&#22810;&#27425;&#37325;&#24314; SqlSessionFactory &#34987;&#35270;&#20026;&#19968;&#31181;&#20195;&#30721;&#8220;&#22351;&#20064;&#24815;&#8221;&#12290;</span>
            <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">&#22240;&#27492; SqlSessionFactory &#30340;&#26368;&#20339;&#20316;&#29992;&#22495;&#26159;&#24212;&#29992;&#20316;&#29992;&#22495;&#12290; &#26377;&#24456;&#22810;&#26041;&#27861;&#21487;&#20197;&#20570;&#21040;&#65292;&#26368;&#31616;&#21333;&#30340;&#23601;&#26159;&#20351;&#29992;&#21333;&#20363;&#27169;&#24335;&#25110;&#32773;&#38745;&#24577;&#21333;&#20363;&#27169;&#24335;&#12290;</span>
            sqlSessionFactory = <span style="color: #BD93F9;">new</span> <span style="color: #AFAFAF;">SqlSessionFactoryBuilder</span>().build(inputStream);
        } <span style="color: #BD93F9;">catch</span> (<span style="color: #AFAFAF;">IOException</span> <span style="color: #AFAFAF;">e</span>) {
            e.printStackTrace();
        }
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #BD93F9;">static</span> <span style="color: #AFAFAF;">SqlSession</span> <span style="color: #AFAFAF;">getSqlSession</span>() {
        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">&#36890;&#36807; sqlSessionFactory &#21019;&#24314; sqlSession</span>
        <span style="color: #BD93F9;">return</span> sqlSessionFactory.openSession();
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org9339da5" class="outline-2">
<h2 id="org9339da5">6. 写实体类 User</h2>
<div class="outline-text-2" id="text-org9339da5">
<p>
新建一个包：model，创建一个实体类：User，对应数据库中的 user。<br>
</p>

<img src="./images/Mybatis02.png" />

<div class="org-src-container">
<pre class="src src-java"><span style="color: #BD93F9;">package</span> com.meta.<span style="color: #009F9F;">model</span>;

<span style="color: #BD93F9;">public</span> <span style="color: #BD93F9;">class</span> <span style="color: #AFAFAF;">User</span> {
    <span style="color: #BD93F9;">private</span> <span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">id</span>;
    <span style="color: #BD93F9;">private</span> <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">username</span>;
    <span style="color: #BD93F9;">private</span> <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">password</span>;

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">User</span>() {
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">User</span>(<span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">id</span>, <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">username</span>, <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">password</span>) {
        <span style="color: #BD93F9;">this</span>.id = id;
        <span style="color: #BD93F9;">this</span>.username = username;
        <span style="color: #BD93F9;">this</span>.password = password;
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">getId</span>() {
        <span style="color: #BD93F9;">return</span> id;
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">void</span> <span style="color: #AFAFAF;">setId</span>(<span style="color: #AFAFAF;">int</span> <span style="color: #AFAFAF;">id</span>) {
        <span style="color: #BD93F9;">this</span>.id = id;
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">getUsername</span>() {
        <span style="color: #BD93F9;">return</span> username;
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">void</span> <span style="color: #AFAFAF;">setUsername</span>(<span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">username</span>) {
        <span style="color: #BD93F9;">this</span>.username = username;
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">getPassword</span>() {
        <span style="color: #BD93F9;">return</span> password;
    }

    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">void</span> <span style="color: #AFAFAF;">setPassword</span>(<span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">password</span>) {
        <span style="color: #BD93F9;">this</span>.password = password;
    }

    <span style="color: #009F9F;">@Override</span>
    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">String</span> <span style="color: #AFAFAF;">toString</span>() {
        <span style="color: #BD93F9;">return</span> <span style="color: #FC9F4E;">"User{"</span> +
            <span style="color: #FC9F4E;">"id="</span> + id +
            <span style="color: #FC9F4E;">", username='"</span> + username + <span style="color: #FC9F4E;">'\''</span> +
            <span style="color: #FC9F4E;">", password='"</span> + password + <span style="color: #FC9F4E;">'\''</span> +
            <span style="color: #FC9F4E;">'}'</span>;
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orga188fa1" class="outline-2">
<h2 id="orga188fa1">7. 写接口 UserMapper</h2>
<div class="outline-text-2" id="text-orga188fa1">
<p>
使用 Mybatis 也还是需要一个接口，Mapper 是 Mybatis 中的一个概念，以后我们都会使用类似 UserMapper 这样的名字。<br>
</p>

<img src="./images/Mybatis02.png" />

<div class="org-src-container">
<pre class="src src-java"><span style="color: #BD93F9;">package</span> com.meta.<span style="color: #009F9F;">dao</span>;

<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">com</span>.<span style="color: #009F9F;">meta</span>.<span style="color: #009F9F;">model</span>.<span style="color: #AFAFAF;">User</span>;

<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">java</span>.<span style="color: #009F9F;">util</span>.<span style="color: #AFAFAF;">List</span>;

<span style="color: #BD93F9;">public</span> <span style="color: #BD93F9;">interface</span> <span style="color: #AFAFAF;">UserMapper</span> {
    <span style="color: #AFAFAF;">List</span>&lt;<span style="color: #AFAFAF;">User</span>&gt; <span style="color: #AFAFAF;">getUserList</span>();
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8dbc215" class="outline-2">
<h2 id="org8dbc215">8. 实现接口，编写 UserMapper.mxl</h2>
<div class="outline-text-2" id="text-org8dbc215">
<img src="./images/Mybatis02.png" />

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #BD93F9;">xml</span> <span style="color: #009F9F; font-style: italic;">version="1.0" encoding="UTF-8" </span>?&gt;
&lt;!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;

<span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">namespace &#32465;&#23450;&#19968;&#20010;&#23545;&#24212;&#30340; Mapper &#25509;&#21475; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
&lt;<span style="color: #AFAFAF;">mapper</span> <span style="color: #AFAFAF;">namespace</span>=<span style="color: #FC9F4E;">"com.meta.dao.UserMapper"</span>&gt;
  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">resultType &#26159;&#36820;&#22238;&#31867;&#22411;&#65292;&#36825;&#37324;&#36820;&#22238;&#30340;&#26159; List&lt;User&gt; &#31867;&#22411;&#65292;&#20294;&#26159;&#21482;&#38656;&#35201;&#20889; User &#23601;&#34892;&#20102; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">select</span> <span style="color: #AFAFAF;">id</span>=<span style="color: #FC9F4E;">"getUserList"</span> <span style="color: #AFAFAF;">resultType</span>=<span style="color: #FC9F4E;">"com.meta.model.User"</span>&gt;
    select * from mybatis.user
  &lt;/<span style="color: #AFAFAF;">select</span>&gt;
&lt;/<span style="color: #AFAFAF;">mapper</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org920e70d" class="outline-2">
<h2 id="org920e70d">9. 注册 UserMapper.xml</h2>
<div class="outline-text-2" id="text-org920e70d">
<p>
每一个 mapper.xml 都要在 mybatis 的核心文件中注册才能使用。<br>
</p>

<div class="org-src-container">
<pre class="src src-xml">&lt;?<span style="color: #BD93F9;">xml</span> <span style="color: #009F9F; font-style: italic;">version="1.0" encoding="UTF-8" </span>?&gt;
&lt;!DOCTYPE configuration
PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;

&lt;<span style="color: #AFAFAF;">configuration</span>&gt;
  &lt;<span style="color: #AFAFAF;">environments</span> <span style="color: #AFAFAF;">default</span>=<span style="color: #FC9F4E;">"development"</span>&gt;
    &lt;<span style="color: #AFAFAF;">environment</span> <span style="color: #AFAFAF;">id</span>=<span style="color: #FC9F4E;">"development"</span>&gt;
      &lt;<span style="color: #AFAFAF;">transactionManager</span> <span style="color: #AFAFAF;">type</span>=<span style="color: #FC9F4E;">"JDBC"</span>/&gt;
      &lt;<span style="color: #AFAFAF;">dataSource</span> <span style="color: #AFAFAF;">type</span>=<span style="color: #FC9F4E;">"POOLED"</span>&gt;
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"driver"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"com.mysql.cj.jdbc.Driver"</span>/&gt;
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"url"</span>
                  <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"jdbc:mysql://localhost:3306/mybatis?useSSL=true</span><span style="color: #009F9F;">&amp;</span><span style="color: #009F9F;">amp</span><span style="color: #009F9F;">;</span><span style="color: #FC9F4E;">useUnicode=true</span><span style="color: #009F9F;">&amp;</span><span style="color: #009F9F;">amp</span><span style="color: #009F9F;">;</span><span style="color: #FC9F4E;">characterEncoding=UTF-8"</span>/&gt;
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"username"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"root"</span>/&gt;
        &lt;<span style="color: #AFAFAF;">property</span> <span style="color: #AFAFAF;">name</span>=<span style="color: #FC9F4E;">"password"</span> <span style="color: #AFAFAF;">value</span>=<span style="color: #FC9F4E;">"haoran232"</span>/&gt;
      &lt;/<span style="color: #AFAFAF;">dataSource</span>&gt;
    &lt;/<span style="color: #AFAFAF;">environment</span>&gt;
  &lt;/<span style="color: #AFAFAF;">environments</span>&gt;

  <span style="color: #7c7c7c; font-style: italic;">&lt;!-- </span><span style="color: #7c7c7c; font-style: italic;">&#21152;&#19978;&#36825;&#21477; </span><span style="color: #7c7c7c; font-style: italic;">--&gt;</span>
  &lt;<span style="color: #AFAFAF;">mappers</span>&gt;
    &lt;<span style="color: #AFAFAF;">mapper</span> <span style="color: #AFAFAF;">resource</span>=<span style="color: #FC9F4E;">"com/meta/dao/UserMapper.xml"</span> /&gt;
  &lt;/<span style="color: #AFAFAF;">mappers</span>&gt;
&lt;/<span style="color: #AFAFAF;">configuration</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org86e4331" class="outline-2">
<h2 id="org86e4331">10. 然后编写测试代码，查看是否成功</h2>
<div class="outline-text-2" id="text-org86e4331">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #BD93F9;">package</span> com.meta.<span style="color: #009F9F;">dao</span>;

<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">com</span>.<span style="color: #009F9F;">meta</span>.<span style="color: #009F9F;">model</span>.<span style="color: #AFAFAF;">User</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">com</span>.<span style="color: #009F9F;">meta</span>.<span style="color: #009F9F;">utils</span>.<span style="color: #AFAFAF;">MybatisUtils</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">org</span>.<span style="color: #009F9F;">apache</span>.<span style="color: #009F9F;">ibatis</span>.<span style="color: #009F9F;">session</span>.<span style="color: #AFAFAF;">SqlSession</span>;
<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">org</span>.<span style="color: #009F9F;">junit</span>.<span style="color: #AFAFAF;">Test</span>;

<span style="color: #BD93F9;">import</span> <span style="color: #009F9F;">java</span>.<span style="color: #009F9F;">util</span>.<span style="color: #AFAFAF;">List</span>;

<span style="color: #BD93F9;">public</span> <span style="color: #BD93F9;">class</span> <span style="color: #AFAFAF;">UserMapperTest</span> {
    <span style="color: #009F9F;">@Test</span>
    <span style="color: #BD93F9;">public</span> <span style="color: #AFAFAF;">void</span> <span style="color: #AFAFAF;">test</span>() {
        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">1. &#33719;&#24471; SqlSession &#23545;&#35937;</span>
        <span style="color: #AFAFAF;">SqlSession</span> <span style="color: #AFAFAF;">sqlSession</span> = MybatisUtils.getSqlSession();

        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">2. &#25191;&#34892; SQL</span>

        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">&#26041;&#24335;&#19968;&#65306;</span>
        <span style="color: #AFAFAF;">UserMapper</span> <span style="color: #AFAFAF;">mapper</span> = sqlSession.getMapper(UserMapper.<span style="color: #BD93F9;">class</span>);
        <span style="color: #AFAFAF;">List</span>&lt;<span style="color: #AFAFAF;">User</span>&gt; <span style="color: #AFAFAF;">userList</span> = mapper.getUserList();

        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">&#26041;&#24335;&#20108;&#65288;&#19981;&#24314;&#35758;&#20351;&#29992;&#65289;&#65306;</span>
        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">List&lt;User&gt; userList = sqlSession.selectList("com.info.dao.UserDao.getUserList");</span>

        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">3. &#22788;&#29702;&#24471;&#21040;&#30340;&#25968;&#25454;</span>
        <span style="color: #BD93F9;">for</span> (<span style="color: #AFAFAF;">User</span> <span style="color: #AFAFAF;">user</span> : userList) {
            System.out.println(user);
        }

        <span style="color: #7c7c7c; font-style: italic;">// </span><span style="color: #7c7c7c; font-style: italic;">4. &#20851;&#38381; SqlSession</span>
        sqlSession.close();
    }
}
</pre>
</div>

<img src="./images/Mybatis03.png" />
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2021-12-09 12:12 Thu</p>
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2021-12-09 Thu 15:08</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
