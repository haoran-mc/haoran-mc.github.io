<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2023-01-10 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>go文件操作大全</title>
<meta name="author" content="Haoran Liu" />
<meta name="description" content="Copyright © 2023, Haoran Liu, all rights reserved." />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="static/css/org.css"/>
</head>
<body>
<div id="content" class="content">
<h1 class="title">go文件操作大全</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orga4f416b">1. 介绍</a>
<ul>
<li><a href="#org7eb96c6">1.1 万物皆文件</a></li>
</ul>
</li>
<li><a href="#org15c9e4a">2. 基本操作</a>
<ul>
<li><a href="#org892b6b1">2.1 创建空文件</a></li>
<li><a href="#org058f755">2.2 Truncate 文件</a></li>
<li><a href="#org5e335db">2.3 得到文件信息</a></li>
<li><a href="#org7de4d3b">2.4 重命名和移动</a></li>
<li><a href="#org6a7c87a">2.5 删除文件</a></li>
<li><a href="#org88038ac">2.6 打开和关闭文件</a></li>
<li><a href="#orgb447a21">2.7 检查文件是否存在</a></li>
<li><a href="#orgc29ee66">2.8 检查读写权限</a></li>
<li><a href="#orgbff68a0">2.9 改变权限、拥有者、时间戳</a></li>
<li><a href="#org676dc63">2.10 硬链接和软链接</a></li>
</ul>
</li>
<li><a href="#org7136236">3. 读写</a>
<ul>
<li><a href="#org1d723b6">3.1 复制文件</a></li>
</ul>
</li>
<li><a href="#org0837793">4. 压缩</a></li>
<li><a href="#orgc3fe15a">5. 其他</a></li>
<li><a href="#orgca37124">6. 参考</a></li>
</ul>
</div>
</div>
<p>
Go 官方库的文件操作分散在多个包中，比如 <code>os</code> 、 <code>ioutil</code> 包。<br>
</p>

<div id="outline-container-orga4f416b" class="outline-2">
<h2 id="orga4f416b">1. 介绍</h2>
<div class="outline-text-2" id="text-orga4f416b">
</div>
<div id="outline-container-org7eb96c6" class="outline-3">
<h3 id="org7eb96c6">1.1 万物皆文件</h3>
<div class="outline-text-3" id="text-org7eb96c6">
<p>
UNIX 的一个基础设计就是"万物皆文件"（everything is a file）。我们不必知道一个文件到底映射成什么，操作系统的设备驱动抽象成文件。操作系统为设备提供了文件格式的接口。<br>
</p>

<p>
Go语言中的reader和writer接口也类似。我们只需简单的读写字节，不必知道reader的数据来自哪里，也不必知道writer将数据发送到哪里。<br>
</p>

<p>
你可以在/dev下查看可用的设备，有些可能需要较高的权限才能访问。<br>
</p>
</div>
</div>
</div>
<div id="outline-container-org15c9e4a" class="outline-2">
<h2 id="org15c9e4a">2. 基本操作</h2>
<div class="outline-text-2" id="text-org15c9e4a">
</div>
<div id="outline-container-org892b6b1" class="outline-3">
<h3 id="org892b6b1">2.1 创建空文件</h3>
<div class="outline-text-3" id="text-org892b6b1">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">var</span> (
    <span style="color: #cbccc6;">newFile</span> *<span style="color: #ffe6b3;">os.File</span>
    <span style="color: #cbccc6;">err</span>     <span style="color: #ffe6b3;">error</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    newFile, err = os.<span style="color: #ffd580;">Create</span>(<span style="color: #bae67e;">"test.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
    log.<span style="color: #ffd580;">Println</span>(newFile)
    newFile.<span style="color: #ffd580;">Close</span>()
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #cbccc6;">file</span>, <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">OpenFile</span>(<span style="color: #bae67e;">"test.txt"</span>, os.O_RDONLY|os.O_CREATE, 0666)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
    file.<span style="color: #ffd580;">Close</span>()
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org058f755" class="outline-3">
<h3 id="org058f755">2.2 Truncate 文件</h3>
<div class="outline-text-3" id="text-org058f755">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#35009;&#21098;&#19968;&#20010;&#25991;&#20214;&#21040;100&#20010;&#23383;&#33410;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#22914;&#26524;&#25991;&#20214;&#26412;&#26469;&#23601;&#23569;&#20110;100&#20010;&#23383;&#33410;&#65292;&#21017;&#25991;&#20214;&#20013;&#21407;&#22987;&#20869;&#23481;&#24471;&#20197;&#20445;&#30041;&#65292;&#21097;&#20313;&#30340;&#23383;&#33410;&#20197;null&#23383;&#33410;&#22635;&#20805;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#22914;&#26524;&#25991;&#20214;&#26412;&#26469;&#36229;&#36807;100&#20010;&#23383;&#33410;&#65292;&#21017;&#36229;&#36807;&#30340;&#23383;&#33410;&#20250;&#34987;&#25243;&#24323;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#36825;&#26679;&#25105;&#20204;&#24635;&#26159;&#24471;&#21040;&#31934;&#30830;&#30340;100&#20010;&#23383;&#33410;&#30340;&#25991;&#20214;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#20256;&#20837;0&#21017;&#20250;&#28165;&#31354;&#25991;&#20214;&#12290;</span>

    <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Truncate</span>(<span style="color: #bae67e;">"test.txt"</span>, 100)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org5e335db" class="outline-3">
<h3 id="org5e335db">2.3 得到文件信息</h3>
<div class="outline-text-3" id="text-org5e335db">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"fmt"</span>
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">var</span> (
    <span style="color: #cbccc6;">fileInfo</span> <span style="color: #ffe6b3;">os.FileInfo</span>
    <span style="color: #cbccc6;">err</span>      <span style="color: #ffe6b3;">error</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#22914;&#26524;&#25991;&#20214;&#19981;&#23384;&#22312;&#65292;&#21017;&#36820;&#22238;&#38169;&#35823;</span>
    fileInfo, err = os.<span style="color: #ffd580;">Stat</span>(<span style="color: #bae67e;">"test.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }

    fmt.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"File name:"</span>, fileInfo.<span style="color: #ffd580;">Name</span>())
    fmt.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Size in bytes:"</span>, fileInfo.<span style="color: #ffd580;">Size</span>())
    fmt.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Permissions:"</span>, fileInfo.<span style="color: #ffd580;">Mode</span>())
    fmt.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Last modified:"</span>, fileInfo.<span style="color: #ffd580;">ModTime</span>())
    fmt.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Is Directory:"</span>, fileInfo.<span style="color: #ffd580;">IsDir</span>())
    fmt.<span style="color: #ffd580;">Printf</span>(<span style="color: #bae67e;">"System interface type: %T\n"</span>, fileInfo.<span style="color: #ffd580;">Sys</span>())
    fmt.<span style="color: #ffd580;">Printf</span>(<span style="color: #bae67e;">"System info: %+v\n\n"</span>, fileInfo.<span style="color: #ffd580;">Sys</span>())
}
</pre>
</div>

<pre class="example" id="orgb6259e2">
File name: test.txt
Size in bytes: 100
Permissions: -rw-r--r--
Last modified: 2023-01-03 11:06:45.165638664 +0800 CST
Is Directory: false
System interface type: *syscall.Stat_t
System info: &amp;{Dev:16777234 Mode:33188 Nlink:1 Ino:43139345 Uid:501 Gid:20 Rdev:0 Pad_cgo_0:[0 0 0 0] Atimespec:{Sec:1672715215 Nsec:575296675} Mtimespec:{Sec:1672715205 Nsec:165638664} Ctimespec:{Sec:1672715205 Nsec:165638664} Birthtimespec:{Sec:1672715168 Nsec:351182182} Size:100 Blocks:0 Blksize:4096 Flags:0 Gen:0 Lspare:0 Qspare:[0 0]}
</pre>
</div>
</div>
<div id="outline-container-org7de4d3b" class="outline-3">
<h3 id="org7de4d3b">2.4 重命名和移动</h3>
<div class="outline-text-3" id="text-org7de4d3b">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #cbccc6;">originalPath</span> := <span style="color: #bae67e;">"test.txt"</span>
    <span style="color: #cbccc6;">newPath</span> := <span style="color: #bae67e;">"test2.txt"</span>
    <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Rename</span>(originalPath, newPath)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org6a7c87a" class="outline-3">
<h3 id="org6a7c87a">2.5 删除文件</h3>
<div class="outline-text-3" id="text-org6a7c87a">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Remove</span>(<span style="color: #bae67e;">"test2.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org88038ac" class="outline-3">
<h3 id="org88038ac">2.6 打开和关闭文件</h3>
<div class="outline-text-3" id="text-org88038ac">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#31616;&#21333;&#22320;&#20197;&#21482;&#35835;&#30340;&#26041;&#24335;&#25171;&#24320;&#65292;&#19979;&#38754;&#30340;&#20363;&#23376;&#20250;&#20171;&#32461;&#35835;&#20889;&#30340;&#20363;&#23376;&#12290;</span>
    <span style="color: #cbccc6;">file</span>, <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Open</span>(<span style="color: #bae67e;">"test.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
    file.<span style="color: #ffd580;">Close</span>()

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">OpenFile &#25552;&#20379;&#26356;&#22810;&#30340;&#36873;&#39033;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#26368;&#21518;&#19968;&#20010;&#21442;&#25968;&#26159;&#26435;&#38480;&#27169;&#24335; permission mode</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#31532;&#20108;&#20010;&#26159;&#25171;&#24320;&#26102;&#30340;&#23646;&#24615;</span>
    file, err = os.<span style="color: #ffd580;">OpenFile</span>(<span style="color: #bae67e;">"test.txt"</span>, os.O_APPEND, 0666)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
    file.<span style="color: #ffd580;">Close</span>()

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#19979;&#38754;&#30340;&#23646;&#24615;&#21487;&#20197;&#21333;&#29420;&#20351;&#29992;&#65292;&#20063;&#21487;&#20197;&#32452;&#21512;&#20351;&#29992;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#32452;&#21512;&#20351;&#29992;&#26102;&#21487;&#20197;&#20351;&#29992; OR &#25805;&#20316;&#35774;&#32622; OpenFile &#30340;&#31532;&#20108;&#20010;&#21442;&#25968;&#65292;&#20363;&#22914;&#65306;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_CREATE|os.O_APPEND</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#25110;&#32773; os.O_CREATE|os.O_TRUNC|os.O_WRONLY</span>

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_RDONLY // &#21482;&#35835;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_WRONLY // &#21482;&#20889;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_RDWR   // &#35835;&#20889;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_APPEND // &#24448;&#25991;&#20214;&#20013;&#28155;&#24314;&#65288;Append&#65289;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_CREATE // &#22914;&#26524;&#25991;&#20214;&#19981;&#23384;&#22312;&#21017;&#20808;&#21019;&#24314;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_TRUNC  // &#25991;&#20214;&#25171;&#24320;&#26102;&#35009;&#21098;&#25991;&#20214;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_EXCL   // &#21644;O_CREATE&#19968;&#36215;&#20351;&#29992;&#65292;&#25991;&#20214;&#19981;&#33021;&#23384;&#22312;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">os.O_SYNC   // &#20197;&#21516;&#27493;I/O&#30340;&#26041;&#24335;&#25171;&#24320;</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb447a21" class="outline-3">
<h3 id="orgb447a21">2.7 检查文件是否存在</h3>
<div class="outline-text-3" id="text-orgb447a21">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#25991;&#20214;&#19981;&#23384;&#22312;&#21017;&#36820;&#22238; error</span>
    <span style="color: #cbccc6;">fileInfo</span>, <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Stat</span>(<span style="color: #bae67e;">"test.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        <span style="color: #ffa759;">if</span> os.<span style="color: #ffd580;">IsNotExist</span>(err) {
            log.<span style="color: #ffd580;">Fatal</span>(<span style="color: #bae67e;">"File does no exist."</span>)
        }
    }
    log.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"File does exist. File information:"</span>)
    log.<span style="color: #ffd580;">Println</span>(fileInfo)
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc29ee66" class="outline-3">
<h3 id="orgc29ee66">2.8 检查读写权限</h3>
<div class="outline-text-3" id="text-orgc29ee66">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#36825;&#20010;&#20363;&#23376;&#27979;&#35797;&#20889;&#26435;&#38480;&#65292;&#22914;&#26524;&#27809;&#26377;&#20889;&#26435;&#38480;&#21017;&#36820;&#22238; error&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#27880;&#24847;&#25991;&#20214;&#19981;&#23384;&#22312;&#20063;&#20250;&#36820;&#22238; error&#65292;&#38656;&#35201;&#26816;&#26597; error &#30340;&#20449;&#24687;&#26469;&#33719;&#21462;&#26159;&#21738;&#20010;&#38169;&#35823;&#23548;&#33268;&#30340;&#12290;</span>
    <span style="color: #cbccc6;">file</span>, <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">OpenFile</span>(<span style="color: #bae67e;">"test.txt"</span>, os.O_WRONLY, 0666)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        <span style="color: #ffa759;">if</span> os.<span style="color: #ffd580;">IsPermission</span>(err) {
            log.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Error: Write permission denied."</span>)
        } <span style="color: #ffa759;">else</span> <span style="color: #ffa759;">if</span> os.<span style="color: #ffd580;">IsNotExist</span>(err) {
            log.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Error: File is not exist."</span>)
        }
    }
    file.<span style="color: #ffd580;">Close</span>()

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#27979;&#35797;&#35835;&#26435;&#38480;</span>
    file, err = os.<span style="color: #ffd580;">OpenFile</span>(<span style="color: #bae67e;">"test.txt"</span>, os.O_RDONLY, 0666)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        <span style="color: #ffa759;">if</span> os.<span style="color: #ffd580;">IsPermission</span>(err) {
            log.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Error: Read permission denied."</span>)
        } <span style="color: #ffa759;">else</span> <span style="color: #ffa759;">if</span> os.<span style="color: #ffd580;">IsNotExist</span>(err) {
            log.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"Error: File is not exist."</span>)
        }
    }
    file.<span style="color: #ffd580;">Close</span>()
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbff68a0" class="outline-3">
<h3 id="orgbff68a0">2.9 改变权限、拥有者、时间戳</h3>
<div class="outline-text-3" id="text-orgbff68a0">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main

<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"os"</span>
    <span style="color: #bae67e;">"time"</span>
)

<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#20351;&#29992; Linux &#39118;&#26684;&#25913;&#21464;&#25991;&#20214;&#26435;&#38480;</span>
    <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Chmod</span>(<span style="color: #bae67e;">"test.txt"</span>, 0777)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Println</span>(err)
    }

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#25913;&#21464;&#25991;&#20214;&#25152;&#26377;&#32773;</span>
    err = os.<span style="color: #ffd580;">Chown</span>(<span style="color: #bae67e;">"test.txt"</span>, os.<span style="color: #ffd580;">Geteuid</span>(), os.<span style="color: #ffd580;">Getegid</span>())
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Println</span>(err)
    }

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#25913;&#21464;&#26102;&#38388;&#25139;</span>
    <span style="color: #cbccc6;">twoDaysFromNow</span> := time.<span style="color: #ffd580;">Now</span>().<span style="color: #ffd580;">Add</span>(48 * time.Hour)
    <span style="color: #cbccc6;">lastAccessTime</span> := twoDaysFromNow
    <span style="color: #cbccc6;">lastModifyTime</span> := twoDaysFromNow
    err = os.<span style="color: #ffd580;">Chtimes</span>(<span style="color: #bae67e;">"test.txt"</span>, lastAccessTime, lastModifyTime)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Println</span>(err)
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org676dc63" class="outline-3">
<h3 id="org676dc63">2.10 硬链接和软链接</h3>
<div class="outline-text-3" id="text-org676dc63">
<p>
一个普通的文件是一个指向硬盘的 inode 的地方。<br>
</p>

<p>
硬链接创建一个新的指针指向同一个地方。只有所有的链接被删除后文件才会被删除。硬链接只在相同的文件系统中才工作。你可以认为一个硬链接是一个正常的链接。<br>
</p>

<p>
symbolic link，又叫软连接，和硬链接有点不一样，它不直接指向硬盘中的相同的地方，而是通过名字引用其它文件。他们可以指向不同的文件系统中的不同文件。并不是所有的操作系统都支持软链接。<br>
</p>

<div class="org-src-container">
<pre class="src src-go"><span style="color: #ffa759;">package</span> main
<span style="color: #ffa759;">import</span> (
    <span style="color: #bae67e;">"os"</span>
    <span style="color: #bae67e;">"log"</span>
    <span style="color: #bae67e;">"fmt"</span>
)
<span style="color: #ffa759;">func</span> <span style="color: #ffd580;">main</span>() {
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#21019;&#24314;&#19968;&#20010;&#30828;&#38142;&#25509;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#21019;&#24314;&#21518;&#21516;&#19968;&#20010;&#25991;&#20214;&#20869;&#23481;&#20250;&#26377;&#20004;&#20010;&#25991;&#20214;&#21517;&#65292;&#25913;&#21464;&#19968;&#20010;&#25991;&#20214;&#30340;&#20869;&#23481;&#20250;&#24433;&#21709;&#21478;&#19968;&#20010;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#21024;&#38500;&#21644;&#37325;&#21629;&#21517;&#19981;&#20250;&#24433;&#21709;&#21478;&#19968;&#20010;&#12290;</span>
    <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Link</span>(<span style="color: #bae67e;">"original.txt"</span>, <span style="color: #bae67e;">"original_also.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }

    fmt.<span style="color: #ffd580;">Println</span>(<span style="color: #bae67e;">"creating sym"</span>)
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">Create a symlink</span>
    err = os.<span style="color: #ffd580;">Symlink</span>(<span style="color: #bae67e;">"original.txt"</span>, <span style="color: #bae67e;">"original_sym.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">Lstat &#36820;&#22238;&#19968;&#20010;&#25991;&#20214;&#30340;&#20449;&#24687;&#65292;&#20294;&#26159;&#24403;&#25991;&#20214;&#26159;&#19968;&#20010;&#36719;&#38142;&#25509;&#26102;&#65292;&#23427;&#36820;&#22238;&#36719;&#38142;&#25509;&#30340;&#20449;&#24687;&#65292;&#32780;&#19981;&#26159;&#24341;&#29992;&#30340;&#25991;&#20214;&#30340;&#20449;&#24687;&#12290;</span>
    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">Symlink &#22312; Windows &#20013;&#19981;&#24037;&#20316;&#12290;</span>
    <span style="color: #cbccc6;">fileInfo</span>, <span style="color: #cbccc6;">err</span> := os.<span style="color: #ffd580;">Lstat</span>(<span style="color: #bae67e;">"original_sym.txt"</span>)
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
    fmt.<span style="color: #ffd580;">Printf</span>(<span style="color: #bae67e;">"Link info: %+v"</span>, fileInfo)

    <span style="color: #484f5b;">// </span><span style="color: #484f5b;">&#25913;&#21464;&#36719;&#38142;&#25509;&#30340;&#25317;&#26377;&#32773;&#19981;&#20250;&#24433;&#21709;&#21407;&#22987;&#25991;&#20214;&#12290;</span>
    err = os.<span style="color: #ffd580;">Lchown</span>(<span style="color: #bae67e;">"original_sym.txt"</span>, os.<span style="color: #ffd580;">Getuid</span>(), os.<span style="color: #ffd580;">Getgid</span>())
    <span style="color: #ffa759;">if</span> err != <span style="color: #d4bfff;">nil</span> {
        log.<span style="color: #ffd580;">Fatal</span>(err)
    }
}
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org7136236" class="outline-2">
<h2 id="org7136236">3. 读写</h2>
<div class="outline-text-2" id="text-org7136236">
</div>
<div id="outline-container-org1d723b6" class="outline-3">
<h3 id="org1d723b6">3.1 复制文件</h3>
<div class="outline-text-3" id="text-org1d723b6">
<div class="org-src-container">
<pre class="src src-go">
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org0837793" class="outline-2">
<h2 id="org0837793">4. 压缩</h2>
</div>

<div id="outline-container-orgc3fe15a" class="outline-2">
<h2 id="orgc3fe15a">5. 其他</h2>
</div>
<div id="outline-container-orgca37124" class="outline-2">
<h2 id="orgca37124">6. 参考</h2>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-01-03 10:01 Tue</p>
<p class="author">Author: Haoran Liu</p>
<p class="date">Created: 2023-01-10</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
