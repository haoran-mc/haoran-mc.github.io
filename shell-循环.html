<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2023-01-28 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SHELL-循环</title>
<meta name="author" content="Haoran Liu" />
<meta name="description" content="Copyright © 2023, Haoran Liu, all rights reserved." />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="static/css/org.css"/>
</head>
<body>
<div id="content" class="content">
<h1 class="title">SHELL-循环</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org101f192">for</a>
<ul>
<li>
<ul>
<li><a href="#org492bc1c">更改字段分隔符</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org76db411">while</a></li>
<li><a href="#org7b2953f">unitl</a></li>
<li><a href="#org620b5c3">控制循环</a></li>
<li><a href="#org7bb1a1e">处理循环的输出</a></li>
</ul>
</div>
</div>

<div id="outline-container-org101f192" class="outline-2">
<h2 id="org101f192">for</h2>
<div class="outline-text-2" id="text-org101f192">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #546A90;">#</span><span style="color: #546A90;">!/bin/</span><span style="color: #ff2afc; font-weight: bold;">bash</span>
<span style="color: #ff2afc; font-weight: bold;">for</span> animal<span style="color: #ff2afc; font-weight: bold;"> in</span> dog cat elephant
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"There are ${animal}s..."</span>
<span style="color: #ff2afc; font-weight: bold;">done</span>

<span style="color: #ff2afc; font-weight: bold;">for</span> username<span style="color: #ff2afc; font-weight: bold;"> in</span> ${<span style="color: #df85ff;">users</span>}
<span style="color: #ff2afc; font-weight: bold;">do</span>
  id ${<span style="color: #df85ff;">username</span>}
<span style="color: #ff2afc; font-weight: bold;">done</span>

<span style="color: #ff2afc; font-weight: bold;">for</span> i<span style="color: #ff2afc; font-weight: bold;"> in</span> ${<span style="color: #df85ff;">seq</span> 1 100}
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">echo</span> ${<span style="color: #df85ff;">i</span>}
<span style="color: #ff2afc; font-weight: bold;">done</span>

<span style="color: #ff2afc; font-weight: bold;">for</span> i<span style="color: #ff2afc; font-weight: bold;"> in</span> {1...100}
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">echo</span> ${<span style="color: #df85ff;">i</span>}
<span style="color: #ff2afc; font-weight: bold;">done</span>

<span style="color: #546A90;"># </span><span style="color: #546A90;">bash shell &#31243;&#24207;&#20013; C &#35821;&#35328;&#39118;&#26684;&#30340; for &#21629;&#20196;</span>
<span style="color: #ff2afc; font-weight: bold;">for</span> (( <span style="color: #df85ff;">i</span>=1; i&lt;=100; <span style="color: #df85ff;">i</span>=i+1 ))
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">echo</span> ${<span style="color: #df85ff;">i</span>}
<span style="color: #ff2afc; font-weight: bold;">done</span>

<span style="color: #ff2afc; font-weight: bold;">for</span> (( <span style="color: #df85ff;">a</span>=1, <span style="color: #df85ff;">b</span>=10; a &lt;= 10; a++, b-- ))
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"$a - $b"</span>
<span style="color: #ff2afc; font-weight: bold;">done</span>
</pre>
</div>
</div>
<div id="outline-container-org492bc1c" class="outline-4">
<h4 id="org492bc1c">更改字段分隔符</h4>
<div class="outline-text-4" id="text-org492bc1c">
<p>
默认情况下，bash shell 会将下列字符当作字段分隔符：<br>
</p>

<ul class="org-ul">
<li>空格<br></li>
<li>制表符<br></li>
<li>换行符<br></li>
</ul>

<p>
如果想要修改分隔符：<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #df85ff;">IFS</span>=$<span style="color: #7984D1;">'\n'</span>

IFS.OLD=$<span style="color: #df85ff;">IFS</span>
<span style="color: #df85ff;">IFS</span>=$<span style="color: #7984D1;">'\n'</span>
<span style="color: #546A90;"># </span><span style="color: #546A90;">&#22312;&#20195;&#30721;&#20013;&#20351;&#29992;&#26032;&#30340; IFS &#20540;</span>
<span style="color: #df85ff;">IFS</span>=$<span style="color: #df85ff;">IFS</span>.OLD

<span style="color: #546A90;"># </span><span style="color: #546A90;">&#25351;&#23450;&#22810;&#20010;&#20998;&#38548;&#31526;&#65292;&#21482;&#35201;&#23558;&#23427;&#20204;&#22312;&#36171;&#20540;&#34892;&#20018;&#36215;&#26469;&#23601;&#34892;</span>
<span style="color: #df85ff;">IFS</span>=$<span style="color: #7984D1;">'\n'</span>:;<span style="color: #7984D1;">"</span>
<span style="color: #7984D1;"># &#25442;&#34892;&#31526;&#12289;&#20882;&#21495;&#12289;&#20998;&#21495;&#12289;&#21452;&#24341;&#21495;</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org76db411" class="outline-2">
<h2 id="org76db411">while</h2>
<div class="outline-text-2" id="text-org76db411">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #546A90;">#</span><span style="color: #546A90;">!/bin/</span><span style="color: #ff2afc; font-weight: bold;">bash</span>
<span style="color: #546A90;"># </span><span style="color: #546A90;">&#24403; ${yn} != yes &#19988; ${yn} != YES&#65292;&#37027;&#20040;&#32487;&#32493;&#24490;&#29615;</span>
<span style="color: #ff2afc; font-weight: bold;">while</span> [ <span style="color: #7984D1;">"${yn}"</span> != <span style="color: #7984D1;">"yes"</span> -a <span style="color: #7984D1;">"{yn}"</span> != <span style="color: #7984D1;">"YES"</span> ]
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">read</span> -p <span style="color: #7984D1;">"Please input yes/YES to stop this program: "</span> yn
<span style="color: #ff2afc; font-weight: bold;">done</span>
<span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"OK! you input the correct answer."</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7b2953f" class="outline-2">
<h2 id="org7b2953f">unitl</h2>
<div class="outline-text-2" id="text-org7b2953f">
<div class="org-src-container">
<pre class="src src-shell"><span style="color: #546A90;">#</span><span style="color: #546A90;">!/bin/</span><span style="color: #ff2afc; font-weight: bold;">bash</span>
<span style="color: #546A90;"># </span><span style="color: #546A90;">&#30452;&#21040; ${yn} == yes &#25110; ${yn} == YES&#65292;&#37027;&#20040;&#20572;&#27490;&#24490;&#29615;</span>
<span style="color: #ff2afc; font-weight: bold;">until</span> [ <span style="color: #7984D1;">"${yn}"</span> == <span style="color: #7984D1;">"yes"</span> -o <span style="color: #7984D1;">"${yn}"</span> == <span style="color: #7984D1;">"YES"</span> ]
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #1ea8fc;">read</span> -p <span style="color: #7984D1;">"Please input yes/YES to stop this program: "</span> yn
<span style="color: #ff2afc; font-weight: bold;">done</span>
<span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"OK! you input the correct answer."</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org620b5c3" class="outline-2">
<h2 id="org620b5c3">控制循环</h2>
<div class="outline-text-2" id="text-org620b5c3">
<ul class="org-ul">
<li><p>
break<br>
</p>

<p>
可以指定跳出的循环层级。<br>
</p>

<ul class="org-ul">
<li><code>break 1</code> 会跳出当前循环<br></li>
<li><code>break 2</code> 会跳出下一级的内部循环<br></li>
</ul></li>

<li><p>
continue<br>
</p>

<p>
也可以指定继续哪一级的循环， <code>continue n</code> 。<br>
</p></li>

<li><p>
exit<br>
</p>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">退出码</th>
<th scope="col" class="org-left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">成功退出</td>
</tr>

<tr>
<td class="org-right">126</td>
<td class="org-left">文件不可执行</td>
</tr>

<tr>
<td class="org-right">127</td>
<td class="org-left">命令未找到</td>
</tr>

<tr>
<td class="org-right">128及以上</td>
<td class="org-left">出现一个信号</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
<div id="outline-container-org7bb1a1e" class="outline-2">
<h2 id="org7bb1a1e">处理循环的输出</h2>
<div class="outline-text-2" id="text-org7bb1a1e">
<ul class="org-ul">
<li><p>
重定向输出<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #ff2afc; font-weight: bold;">for</span> file<span style="color: #ff2afc; font-weight: bold;"> in</span> /home/rich/*
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #ff2afc; font-weight: bold;">if</span> [ -d <span style="color: #7984D1;">"$file"</span> ]
  <span style="color: #ff2afc; font-weight: bold;">then</span>
    <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"$file is a directory"</span>
  <span style="color: #ff2afc; font-weight: bold;">elif</span>
    <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"$file is a file"</span>
  <span style="color: #ff2afc; font-weight: bold;">fi</span>
<span style="color: #ff2afc; font-weight: bold;">done</span> &gt; output.txt
</pre>
</div></li>

<li><p>
管道<br>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #ff2afc; font-weight: bold;">for</span> file<span style="color: #ff2afc; font-weight: bold;"> in</span> /home/rich/*
<span style="color: #ff2afc; font-weight: bold;">do</span>
  <span style="color: #ff2afc; font-weight: bold;">if</span> [ -d <span style="color: #7984D1;">"$file"</span> ]
  <span style="color: #ff2afc; font-weight: bold;">then</span>
    <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"$file is a directory"</span>
  <span style="color: #ff2afc; font-weight: bold;">elif</span>
    <span style="color: #1ea8fc;">echo</span> <span style="color: #7984D1;">"$file is a file"</span>
  <span style="color: #ff2afc; font-weight: bold;">fi</span>
<span style="color: #ff2afc; font-weight: bold;">done</span> | sort
</pre>
</div></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2023-01-28 00:01 Sat</p>
<p class="author">Author: Haoran Liu</p>
<p class="date">Created: 2023-01-28</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
