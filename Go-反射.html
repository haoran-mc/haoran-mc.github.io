<!DOCTYPE html>
<html lang="zh">
<head>
<!-- 2022-07-09 Sat 01:25 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>反射</title>
<meta name="generator" content="Org mode">
<meta name="author" content="L.M.haoran">
<meta name="description" content="Copyright © 2022, L.M.haoran, all rights reserved."
>

                <link rel="stylesheet" href="static/css/org.css" type="text/css"  />
                <script type="module" src="static/js/main.js" defer></script>
                <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="content">
<h1 class="title">反射</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org33a9f44">什么是反射</a></li>
<li><a href="#org2cfd231">变量的内在机制</a></li>
<li><a href="#orgceea6a7">反射的使用</a></li>
<li><a href="#org539c1a4">空接口与反射</a>
<ul>
<li><a href="#org8708489">获取 interface 类型（Type、Kind）；</a></li>
<li><a href="#org690c384">获取 interface 值信息（ValueOf、Int）：</a></li>
<li><a href="#orgf5628e8">反射修改值信息</a></li>
</ul>
</li>
<li><a href="#orgb8b2285">结构体与反射</a>
<ul>
<li><a href="#org737f9d5">查看类型、字段和方法：</a></li>
<li><a href="#orgddef7aa">查看匿名字段：</a></li>
<li><a href="#org0abd249">修改结构体的值：</a></li>
<li><a href="#orgb954f30">调用方法：</a></li>
<li><a href="#orge8cb312">获取字段的 tag：</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org33a9f44" class="outline-2">
<h2 id="org33a9f44">什么是反射</h2>
<div class="outline-text-2" id="text-org33a9f44">
<p>
反射是指在程序运行期对程序本身进行访问和修改的能力。<br>
</p>
</div>
</div>
<div id="outline-container-org2cfd231" class="outline-2">
<h2 id="org2cfd231">变量的内在机制</h2>
<div class="outline-text-2" id="text-org2cfd231">
<ul class="org-ul">
<li>变量包含类型信息和值信息 <code>var arr [10]int arr[0] = 10</code><br></li>
<li>类型信息：是静态的元信息，是预先定义好的；<br></li>
<li>值信息：是程序运行过程中动态改变的；<br></li>
</ul>
</div>
</div>
<div id="outline-container-orgceea6a7" class="outline-2">
<h2 id="orgceea6a7">反射的使用</h2>
<div class="outline-text-2" id="text-orgceea6a7">
<ul class="org-ul">
<li>reflect 包封装了反射相关的方法；<br></li>
<li>获取类型信息：reflect.TypeOf，是静态的；<br></li>
<li>获取值信息：reflect.ValueOf，是动态的；<br></li>
</ul>
</div>
</div>
<div id="outline-container-org539c1a4" class="outline-2">
<h2 id="org539c1a4">空接口与反射</h2>
<div class="outline-text-2" id="text-org539c1a4">
<p>
反射可以在运行时动态获取程序的各种详细信息；<br>
</p>
</div>
<div id="outline-container-org8708489" class="outline-3">
<h3 id="org8708489">获取 interface 类型（Type、Kind）；</h3>
<div class="outline-text-3" id="text-org8708489">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">myint</span> <span style="color: #df005f; font-weight: bold;">int</span>

<span style="color: #008787; background-color: #262626;">//</span><span style="color: #008787; background-color: #262626;">&#21453;&#23556;&#33719;&#21462;interface&#31867;&#22411;&#20449;&#24687;</span>
<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">reflect_type</span>(<span style="color: #8787d7;">a</span> <span style="color: #268bd2; font-weight: bold;">interface</span>{}) {
    <span style="color: #8787d7;">t</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">TypeOf</span>(a)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"type: "</span>, t)
    <span style="color: #8787d7;">k</span> := t.<span style="color: #d75fd7; font-weight: bold;">Kind</span>() <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">kind() &#21487;&#20197;&#33719;&#21462;&#20855;&#20307;&#31867;&#22411;</span>
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"kind: "</span>, k)
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #268bd2; font-weight: bold;">var</span> <span style="color: #8787d7;">x</span> <span style="color: #df005f; font-weight: bold;">myint</span> = 17
    <span style="color: #d75fd7; font-weight: bold;">reflect_type</span>(x)
}
</pre>
</div>

<pre class="example">
type:  main.myint
kind:  int 
</pre>
</div>
</div>
<div id="outline-container-org690c384" class="outline-3">
<h3 id="org690c384">获取 interface 值信息（ValueOf、Int）：</h3>
<div class="outline-text-3" id="text-org690c384">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">myint</span> <span style="color: #df005f; font-weight: bold;">int</span>

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21453;&#23556;&#33719;&#21462; interface &#20540;&#20449;&#24687;</span>
<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">reflect_value</span>(<span style="color: #8787d7;">a</span> <span style="color: #268bd2; font-weight: bold;">interface</span>{}) {
    <span style="color: #8787d7;">v</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(a)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"value: "</span>, v)
    <span style="color: #8787d7;">k</span> := v.<span style="color: #d75fd7; font-weight: bold;">Kind</span>()
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"kind: "</span>, k)
    <span style="color: #268bd2; font-weight: bold;">switch</span> k {
    <span style="color: #268bd2; font-weight: bold;">case</span> reflect.Int:
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"value: "</span>, v.<span style="color: #d75fd7; font-weight: bold;">Int</span>())
    }
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #268bd2; font-weight: bold;">var</span> <span style="color: #8787d7;">x</span> <span style="color: #df005f; font-weight: bold;">myint</span> = 17
    <span style="color: #d75fd7; font-weight: bold;">reflect_value</span>(x)
}
</pre>
</div>

<pre class="example">
value:  17
kind:  int
value:  17 
</pre>
</div>
</div>
<div id="outline-container-orgf5628e8" class="outline-3">
<h3 id="orgf5628e8">反射修改值信息</h3>
<div class="outline-text-3" id="text-orgf5628e8">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">myint</span> <span style="color: #df005f; font-weight: bold;">int</span>

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21453;&#23556;&#20462;&#25913;&#20540;</span>
<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">reflect_set_value</span>(<span style="color: #8787d7;">a</span> <span style="color: #268bd2; font-weight: bold;">interface</span>{}) {
    <span style="color: #8787d7;">v</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(a)
    <span style="color: #8787d7;">k</span> := v.<span style="color: #d75fd7; font-weight: bold;">Kind</span>()
    <span style="color: #268bd2; font-weight: bold;">switch</span> k {
    <span style="color: #268bd2; font-weight: bold;">case</span> reflect.Int:
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21453;&#23556;&#20462;&#25913;&#20540;</span>
        v.<span style="color: #d75fd7; font-weight: bold;">SetFloat</span>(19)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"Int: "</span>, v.<span style="color: #d75fd7; font-weight: bold;">Int</span>())
    <span style="color: #268bd2; font-weight: bold;">case</span> reflect.Ptr:   <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#36208;&#36825;&#20010;&#20998;&#25903;</span>
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">Elem() &#33719;&#21462;&#22320;&#22336;&#25351;&#21521;&#30340;&#20540;</span>
        v.<span style="color: #d75fd7; font-weight: bold;">Elem</span>().<span style="color: #d75fd7; font-weight: bold;">SetInt</span>(20)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"pointer1: "</span>, v.<span style="color: #d75fd7; font-weight: bold;">Elem</span>().<span style="color: #d75fd7; font-weight: bold;">Int</span>()) <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#36755;&#20986;&#21464;&#37327;&#20540;</span>
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"pointer2: "</span>, v.<span style="color: #d75fd7; font-weight: bold;">Pointer</span>())    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#36755;&#20986;&#21464;&#37327;&#22320;&#22336;</span>
    }
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #268bd2; font-weight: bold;">var</span> <span style="color: #8787d7;">x</span> <span style="color: #df005f; font-weight: bold;">myint</span> = 17
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21453;&#23556;&#35748;&#20026;&#19979;&#38754;&#26159;&#25351;&#38024;&#31867;&#22411;&#65292;&#19981;&#26159; float &#31867;&#22411;</span>
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"main1: "</span>, x)
    <span style="color: #d75fd7; font-weight: bold;">reflect_set_value</span>(&amp;x)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"main2: "</span>, x)
}
</pre>
</div>

<pre class="example">
main1:  17
pointer1:  20
pointer2:  842350534808
main2:  20 
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb8b2285" class="outline-2">
<h2 id="orgb8b2285">结构体与反射</h2>
<div class="outline-text-2" id="text-orgb8b2285">
</div>
<div id="outline-container-org737f9d5" class="outline-3">
<h3 id="org737f9d5">查看类型、字段和方法：</h3>
<div class="outline-text-3" id="text-org737f9d5">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#23450;&#20041;&#32467;&#26500;&#20307;</span>
<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">User</span> <span style="color: #268bd2; font-weight: bold;">struct</span> {
    Id   <span style="color: #df005f; font-weight: bold;">int</span>
    Name <span style="color: #df005f; font-weight: bold;">string</span>
    Age  <span style="color: #df005f; font-weight: bold;">int</span>
}

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#32465;&#26041;&#27861;</span>
<span style="color: #268bd2; font-weight: bold;">func</span> (<span style="color: #8787d7;">u</span> <span style="color: #df005f; font-weight: bold;">User</span>) <span style="color: #d75fd7; font-weight: bold;">Hello</span>() {
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"Hello"</span>)
}

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#20256;&#20837;interface{}</span>
<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">Poni</span>(<span style="color: #8787d7;">o</span> <span style="color: #268bd2; font-weight: bold;">interface</span>{}) {
    <span style="color: #8787d7;">t</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">TypeOf</span>(o)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"&#31867;&#22411;&#65306;"</span>, t)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"&#23383;&#31526;&#20018;&#31867;&#22411;&#65306;"</span>, t.<span style="color: #d75fd7; font-weight: bold;">Name</span>())
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#33719;&#21462;&#20540;</span>
    <span style="color: #8787d7;">v</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(o)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(v)
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21487;&#20197;&#33719;&#21462;&#25152;&#26377;&#23646;&#24615;</span>
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#33719;&#21462;&#32467;&#26500;&#20307;&#23383;&#27573;&#20010;&#25968;&#65306;t.NumField()</span>
    <span style="color: #268bd2; font-weight: bold;">for</span> <span style="color: #8787d7;">i</span> := 0; i &lt; t.<span style="color: #d75fd7; font-weight: bold;">NumField</span>(); i++ {
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21462;&#27599;&#20010;&#23383;&#27573;</span>
        <span style="color: #8787d7;">f</span> := t.<span style="color: #d75fd7; font-weight: bold;">Field</span>(i)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Printf</span>(<span style="color: #2aa198;">"%s : %v; "</span>, f.Name, f.Type)
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#33719;&#21462;&#23383;&#27573;&#30340;&#20540;&#20449;&#24687;</span>
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">Interface()&#65306;&#33719;&#21462;&#23383;&#27573;&#23545;&#24212;&#30340;&#20540;</span>
        <span style="color: #8787d7;">val</span> := v.<span style="color: #d75fd7; font-weight: bold;">Field</span>(i).<span style="color: #d75fd7; font-weight: bold;">Interface</span>()
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"val :"</span>, val)
    }
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"=================&#26041;&#27861;===================="</span>)
    <span style="color: #268bd2; font-weight: bold;">for</span> <span style="color: #8787d7;">i</span> := 0; i &lt; t.<span style="color: #d75fd7; font-weight: bold;">NumMethod</span>(); i++ {
        <span style="color: #8787d7;">m</span> := t.<span style="color: #d75fd7; font-weight: bold;">Method</span>(i)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(m.Name)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(m.Type)
    }
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #8787d7;">u</span> := <span style="color: #df005f; font-weight: bold;">User</span>{1, <span style="color: #2aa198;">"zs"</span>, 20}
    <span style="color: #d75fd7; font-weight: bold;">Poni</span>(u)
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgddef7aa" class="outline-3">
<h3 id="orgddef7aa">查看匿名字段：</h3>
<div class="outline-text-3" id="text-orgddef7aa">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#23450;&#20041;&#32467;&#26500;&#20307;</span>
<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">User</span> <span style="color: #268bd2; font-weight: bold;">struct</span> {
    Id   <span style="color: #df005f; font-weight: bold;">int</span>
    Name <span style="color: #df005f; font-weight: bold;">string</span>
    Age  <span style="color: #df005f; font-weight: bold;">int</span>
}

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21311;&#21517;&#23383;&#27573;</span>
<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">Boy</span> <span style="color: #268bd2; font-weight: bold;">struct</span> {
    User
    Addr <span style="color: #df005f; font-weight: bold;">string</span>
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #8787d7;">m</span> := <span style="color: #df005f; font-weight: bold;">Boy</span>{<span style="color: #df005f; font-weight: bold;">User</span>{1, <span style="color: #2aa198;">"zs"</span>, 20}, <span style="color: #2aa198;">"bj"</span>}
    <span style="color: #8787d7;">t</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">TypeOf</span>(m)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(t)
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">Anonymous&#65306;&#21311;&#21517;</span>
    fmt.<span style="color: #d75fd7; font-weight: bold;">Printf</span>(<span style="color: #2aa198;">"%#v\n"</span>, t.<span style="color: #d75fd7; font-weight: bold;">Field</span>(0))
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#20540;&#20449;&#24687;</span>
    fmt.<span style="color: #d75fd7; font-weight: bold;">Printf</span>(<span style="color: #2aa198;">"%#v\n"</span>, reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(m).<span style="color: #d75fd7; font-weight: bold;">Field</span>(0))
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org0abd249" class="outline-3">
<h3 id="org0abd249">修改结构体的值：</h3>
<div class="outline-text-3" id="text-org0abd249">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
        <span style="color: #2aa198;">"fmt"</span>
        <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#23450;&#20041;&#32467;&#26500;&#20307;</span>
<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">User</span> <span style="color: #268bd2; font-weight: bold;">struct</span> {
        Id   <span style="color: #df005f; font-weight: bold;">int</span>
        Name <span style="color: #df005f; font-weight: bold;">string</span>
        Age  <span style="color: #df005f; font-weight: bold;">int</span>
}

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#20462;&#25913;&#32467;&#26500;&#20307;&#20540;</span>
<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">SetValue</span>(<span style="color: #8787d7;">o</span> <span style="color: #268bd2; font-weight: bold;">interface</span>{}) {
        <span style="color: #8787d7;">v</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(o)
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#33719;&#21462;&#25351;&#38024;&#25351;&#21521;&#30340;&#20803;&#32032;</span>
        v = v.<span style="color: #d75fd7; font-weight: bold;">Elem</span>()
        <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#21462;&#23383;&#27573;</span>
        <span style="color: #8787d7;">f</span> := v.<span style="color: #d75fd7; font-weight: bold;">FieldByName</span>(<span style="color: #2aa198;">"Name"</span>)
        <span style="color: #268bd2; font-weight: bold;">if</span> f.<span style="color: #d75fd7; font-weight: bold;">Kind</span>() == reflect.String {
                f.<span style="color: #d75fd7; font-weight: bold;">SetString</span>(<span style="color: #2aa198;">"kuteng"</span>)
        }
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
        <span style="color: #8787d7;">u</span> := <span style="color: #df005f; font-weight: bold;">User</span>{1, <span style="color: #2aa198;">"5lmh.com"</span>, 20}
        <span style="color: #d75fd7; font-weight: bold;">SetValue</span>(&amp;u)
        fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(u)
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb954f30" class="outline-3">
<h3 id="orgb954f30">调用方法：</h3>
<div class="outline-text-3" id="text-orgb954f30">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#23450;&#20041;&#32467;&#26500;&#20307;</span>
<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">User</span> <span style="color: #268bd2; font-weight: bold;">struct</span> {
    Id   <span style="color: #df005f; font-weight: bold;">int</span>
    Name <span style="color: #df005f; font-weight: bold;">string</span>
    Age  <span style="color: #df005f; font-weight: bold;">int</span>
}

<span style="color: #268bd2; font-weight: bold;">func</span> (<span style="color: #8787d7;">u</span> <span style="color: #df005f; font-weight: bold;">User</span>) <span style="color: #d75fd7; font-weight: bold;">Hello</span>(<span style="color: #8787d7;">name</span> <span style="color: #df005f; font-weight: bold;">string</span>) {
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(<span style="color: #2aa198;">"Hello&#65306;"</span>, name)
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #8787d7;">u</span> := <span style="color: #df005f; font-weight: bold;">User</span>{1, <span style="color: #2aa198;">"5lmh.com"</span>, 20}
    <span style="color: #8787d7;">v</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(u)
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#33719;&#21462;&#26041;&#27861;</span>
    <span style="color: #8787d7;">m</span> := v.<span style="color: #d75fd7; font-weight: bold;">MethodByName</span>(<span style="color: #2aa198;">"Hello"</span>)
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#26500;&#24314;&#19968;&#20123;&#21442;&#25968;</span>
    <span style="color: #8787d7;">args</span> := []<span style="color: #df005f; font-weight: bold;">reflect.Value</span>{reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(<span style="color: #2aa198;">"6666"</span>)}
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#27809;&#21442;&#25968;&#30340;&#24773;&#20917;&#19979;&#65306;var args2 []reflect.Value</span>
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#35843;&#29992;&#26041;&#27861;&#65292;&#38656;&#35201;&#20256;&#20837;&#26041;&#27861;&#30340;&#21442;&#25968;</span>
    m.<span style="color: #d75fd7; font-weight: bold;">Call</span>(args)
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orge8cb312" class="outline-3">
<h3 id="orge8cb312">获取字段的 tag：</h3>
<div class="outline-text-3" id="text-orge8cb312">
<div class="org-src-container">
<pre class="src src-go"><span style="color: #268bd2; font-weight: bold;">package</span> main

<span style="color: #268bd2; font-weight: bold;">import</span> (
    <span style="color: #2aa198;">"fmt"</span>
    <span style="color: #2aa198;">"reflect"</span>
)

<span style="color: #268bd2; font-weight: bold;">type</span> <span style="color: #df005f; font-weight: bold;">Student</span> <span style="color: #268bd2; font-weight: bold;">struct</span> {
    Name <span style="color: #df005f; font-weight: bold;">string</span> <span style="color: #2aa198;">`json:"name1" db:"name2"`</span>
}

<span style="color: #268bd2; font-weight: bold;">func</span> <span style="color: #d75fd7; font-weight: bold;">main</span>() {
    <span style="color: #268bd2; font-weight: bold;">var</span> <span style="color: #8787d7;">s</span> <span style="color: #df005f; font-weight: bold;">Student</span>
    <span style="color: #8787d7;">v</span> := reflect.<span style="color: #d75fd7; font-weight: bold;">ValueOf</span>(&amp;s)
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#31867;&#22411;</span>
    <span style="color: #8787d7;">t</span> := v.<span style="color: #d75fd7; font-weight: bold;">Type</span>()
    <span style="color: #008787; background-color: #262626;">// </span><span style="color: #008787; background-color: #262626;">&#33719;&#21462;&#23383;&#27573;</span>
    <span style="color: #8787d7;">f</span> := t.<span style="color: #d75fd7; font-weight: bold;">Elem</span>().<span style="color: #d75fd7; font-weight: bold;">Field</span>(0)
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(f.Tag.<span style="color: #d75fd7; font-weight: bold;">Get</span>(<span style="color: #2aa198;">"json"</span>))
    fmt.<span style="color: #d75fd7; font-weight: bold;">Println</span>(f.Tag.<span style="color: #d75fd7; font-weight: bold;">Get</span>(<span style="color: #2aa198;">"db"</span>))
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: L.M.haoran</p>
<p class="date">Created: 2022-07-09 Sat 01:25</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
